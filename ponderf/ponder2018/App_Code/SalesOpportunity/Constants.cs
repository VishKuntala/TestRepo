using System.Collections.Generic;

namespace ponder2018.SalesOpportunity
{
    public static class Constants
    {
        public static Dictionary<string, string> EXPORT_TO_EXCEL_QUERY_DICTIONARY = new Dictionary<string, string>
        {
            { "ExportToExcel_PSALocations", @"SELECT ZIP_CO_PSA, HOUSE_NUMBER, PREFIX, STREET_NAME, BUILDING_NUMBER, UNIT_NUMBER, CITY, ZIP, STATE, CASE WHEN DL_MAX_SPEED > 1 THEN 'Yes' ELSE 'No' END AS HYPERGIG, CASE WHEN REGREEN = 1 THEN 'Yes' ELSE 'No' END AS REGREEN, CASE WHEN ADSL = 1 THEN 'Yes' ELSE 'No' END AS ADSL, CASE WHEN CSI_ELIGIBLE = 1 THEN 'Yes' ELSE 'No' END AS CSI_ELIGIBLE,
                            CASE WHEN SERVICE_STATUS = 'InService' THEN 'Customer' WHEN SERVICE_STATUS IS NULL AND BB_ALL = 1 AND BB_FIBR = 0 THEN  'Upgrade' ELSE 'Prospect' END AS SERVICE_STATUS,
                            DWELLING_TYPE
                            FROM PONDER.SALES_OPP_FIBER_ADDR 
                            WHERE ZIP_CO_PSA = '{0}'
                            ORDER BY STATE, CITY, STREET_NAME, HOUSE_NUMBER, BUILDING_NUMBER, UNIT_NUMBER" },
            { "ExportToExcel_PSALocations_CMA", @"SELECT ZIP_CO_PSA, HOUSE_NUMBER, PREFIX, STREET_NAME, BUILDING_NUMBER, UNIT_NUMBER, CITY, ZIP, STATE, CASE WHEN DL_MAX_SPEED > 1 THEN 'Yes' ELSE 'No' END AS HYPERGIG, CASE WHEN REGREEN = 1 THEN 'Yes' ELSE 'No' END AS REGREEN, CASE WHEN ADSL = 1 THEN 'Yes' ELSE 'No' END AS ADSL, CASE WHEN CSI_ELIGIBLE = 1 THEN 'Yes' ELSE 'No' END AS CSI_ELIGIBLE,
                            CASE WHEN SERVICE_STATUS = 'InService' THEN 'Customer' WHEN SERVICE_STATUS IS NULL AND BB_ALL = 1 AND BB_FIBR = 0 THEN  'Upgrade' ELSE 'Prospect' END AS SERVICE_STATUS,
                            DWELLING_TYPE
                            FROM PONDER.SALES_OPP_FIBER_ADDR 
                            WHERE ZIP_CO_PSA = '{0}'
                            ORDER BY STATE, CITY, STREET_NAME, HOUSE_NUMBER, BUILDING_NUMBER, UNIT_NUMBER" },
            { "ExportToExcel_PSALocations_County",  @"SELECT ZIP_CO_PSA, HOUSE_NUMBER, PREFIX, STREET_NAME, BUILDING_NUMBER, UNIT_NUMBER, CITY, ZIP, STATE, CASE WHEN DL_MAX_SPEED > 1 THEN 'Yes' ELSE 'No' END AS HYPERGIG, CASE WHEN REGREEN = 1 THEN 'Yes' ELSE 'No' END AS REGREEN, CASE WHEN ADSL = 1 THEN 'Yes' ELSE 'No' END AS ADSL, CASE WHEN CSI_ELIGIBLE = 1 THEN 'Yes' ELSE 'No' END AS CSI_ELIGIBLE,
                            CASE WHEN SERVICE_STATUS = 'InService' THEN 'Customer' WHEN SERVICE_STATUS IS NULL AND BB_ALL = 1 AND BB_FIBR = 0 THEN  'Upgrade' ELSE 'Prospect' END AS SERVICE_STATUS,
                            DWELLING_TYPE
                            FROM PONDER.SALES_OPP_FIBER_ADDR 
                            WHERE ZIP_CO_PSA = '{0}'
                            ORDER BY STATE, CITY, STREET_NAME, HOUSE_NUMBER, BUILDING_NUMBER, UNIT_NUMBER" },
            { "ExportToExcel_PSALocationsAllZip", @"SELECT ZIP_CO_PSA, HOUSE_NUMBER, PREFIX, STREET_NAME, BUILDING_NUMBER, UNIT_NUMBER, CITY, ZIP, STATE, CASE WHEN DL_MAX_SPEED > 1 THEN 'Yes' ELSE 'No' END AS HYPERGIG, CASE WHEN REGREEN = 1 THEN 'Yes' ELSE 'No' END AS REGREEN, CASE WHEN ADSL = 1 THEN 'Yes' ELSE 'No' END AS ADSL, CASE WHEN CSI_ELIGIBLE = 1 THEN 'Yes' ELSE 'No' END AS CSI_ELIGIBLE,
                            CASE WHEN SERVICE_STATUS = 'InService' THEN 'Customer' WHEN SERVICE_STATUS IS NULL AND BB_ALL = 1 AND BB_FIBR = 0 THEN  'Upgrade' ELSE 'Prospect' END AS SERVICE_STATUS,
                            DWELLING_TYPE
                            FROM PONDER.SALES_OPP_FIBER_ADDR 
                            WHERE ZIP = '{0}'
                            ORDER BY STATE, CITY, STREET_NAME, HOUSE_NUMBER, BUILDING_NUMBER, UNIT_NUMBER" },
            { "ExportToExcel_PSALocationsAllCMA", @"SELECT TBL1.* FROM (SELECT ZIP_CO_PSA, HOUSE_NUMBER, PREFIX, STREET_NAME, BUILDING_NUMBER, UNIT_NUMBER, CITY, ZIP, STATE, CASE WHEN DL_MAX_SPEED > 1 THEN 'Yes' ELSE 'No' END AS HYPERGIG, CASE WHEN REGREEN = 1 THEN 'Yes' ELSE 'No' END AS REGREEN, CASE WHEN ADSL = 1 THEN 'Yes' ELSE 'No' END AS ADSL, CASE WHEN CSI_ELIGIBLE = 1 THEN 'Yes' ELSE 'No' END AS CSI_ELIGIBLE,
                            CASE WHEN SERVICE_STATUS = 'InService' THEN 'Customer' WHEN SERVICE_STATUS IS NULL AND BB_ALL = 1 AND BB_FIBR = 0 THEN  'Upgrade' ELSE 'Prospect' END AS SERVICE_STATUS,  
                            DWELLING_TYPE FROM PONDER.SALES_OPP_FIBER_ADDR)TBL1
                            INNER JOIN (SELECT ZIP_CO_PSA
                            FROM (SELECT ZIP_CO_PSA, LATITUDE, LONGITUDE, WIRELESS_SCORE, WIRELESS_CATEGORY, ZIP, CMA, SALES_MARKET, CO, PSA, FIBER_AVAILABLE, FIBER_CUSTOMERS, FIBER_OPPORTUNITY
                            FROM PONDER.SALES_OPP_PSA_PROD
                            WHERE CMA = '{0}'
                            AND FIBER_OPPORTUNITY > 10
                            ORDER BY CMA_RANK)
                            WHERE (ROWNUM <= 25))TBL2
                            ON tbl1.zip_co_psa = tbl2.zip_co_psa
                            ORDER BY TBL1.ZIP_CO_PSA, STREET_NAME, HOUSE_NUMBER, BUILDING_NUMBER, UNIT_NUMBER" },
            { "ExportToExcel_PSALocationsAllCounty",  @"SELECT TBL1.* FROM (SELECT ZIP_CO_PSA, HOUSE_NUMBER, PREFIX, STREET_NAME, BUILDING_NUMBER, UNIT_NUMBER, CITY, ZIP, STATE, CASE WHEN DL_MAX_SPEED > 1 THEN 'Yes' ELSE 'No' END AS HYPERGIG, CASE WHEN REGREEN = 1 THEN 'Yes' ELSE 'No' END AS REGREEN, CASE WHEN ADSL = 1 THEN 'Yes' ELSE 'No' END AS ADSL, CASE WHEN CSI_ELIGIBLE = 1 THEN 'Yes' ELSE 'No' END AS CSI_ELIGIBLE,
                            CASE WHEN SERVICE_STATUS = 'InService' THEN 'Customer' WHEN SERVICE_STATUS IS NULL AND BB_ALL = 1 AND BB_FIBR = 0 THEN  'Upgrade' ELSE 'Prospect' END AS SERVICE_STATUS,  
                            DWELLING_TYPE FROM PONDER.SALES_OPP_FIBER_ADDR)TBL1
                            INNER JOIN (SELECT ZIP_CO_PSA
                            FROM (SELECT ZIP_CO_PSA, LATITUDE, LONGITUDE, WIRELESS_SCORE, WIRELESS_CATEGORY, ZIP, CMA, SALES_MARKET, CO, PSA, FIBER_AVAILABLE, FIBER_CUSTOMERS, FIBER_OPPORTUNITY
                            FROM PONDER.SALES_OPP_PSA_PROD
                            WHERE COUNTY_FIPS = '{0}'
                            AND FIBER_OPPORTUNITY > 10
                            ORDER BY COUNTY_RANK)
                            WHERE (ROWNUM <= 25))TBL2
                            ON tbl1.zip_co_psa = tbl2.zip_co_psa
                            ORDER BY TBL1.ZIP_CO_PSA, STREET_NAME, HOUSE_NUMBER, BUILDING_NUMBER, UNIT_NUMBER" },
            { "ExportToExcel_TopMDUsCMA", @"SELECT * FROM (SELECT SALES_MARKET AS VPGM_MARKET, CMA, REPLACE(CMA_NAME, ',', ' ') AS CMA_NAME, CMA_RANK, WIRELESS_SCORE, 
                            CASE WHEN WIRELESS_SCORE = 5 THEN 'Best'
                            WHEN WIRELESS_SCORE = 4 THEN 'Very Strong'
                            WHEN WIRELESS_SCORE = 3 THEN 'Strong'
                            WHEN WIRELESS_SCORE = 2 THEN 'Uneven'
                            WHEN WIRELESS_SCORE = 1 THEN 'Very Weak'
                            ELSE 'Not enough Samples' END AS WIRELESS_SCORE_TEXT, FIBER_AVAILABLE, FIBER_OPPORTUNITY, FIBER_PENETRATION_RATE, 
                            HOUSE_NUMBER, STREET_NAME, CITY, STATE, ZIP, LATITUDE, LONGITUDE, MARKET_RANK 
                            FROM PONDER.SALES_OPP_MDU_PROD TBL1
                            WHERE CMA = '{0}'
                            AND CMA_RANK <= 50
                            ORDER BY CMA_RANK, WIRELESS_SCORE DESC) WHERE ROWNUM <= 50" },
            { "ExportToExcel_TopMDUsCounty", @"SELECT * FROM (SELECT SALES_MARKET AS VPGM_MARKET, COUNTY_RANK, COUNTY_FIPS, WIRELESS_SCORE, 
                            CASE WHEN WIRELESS_SCORE = 5 THEN 'Best'
                            WHEN WIRELESS_SCORE = 4 THEN 'Very Strong'
                            WHEN WIRELESS_SCORE = 3 THEN 'Strong'
                            WHEN WIRELESS_SCORE = 2 THEN 'Uneven'
                            WHEN WIRELESS_SCORE = 1 THEN 'Very Weak'
                            ELSE 'Not enough Samples' END AS WIRELESS_SCORE_TEXT,
                            FIBER_AVAILABLE, FIBER_OPPORTUNITY, FIBER_PENETRATION_RATE, 
                            HOUSE_NUMBER, STREET_NAME, CITY, STATE, ZIP, LATITUDE, LONGITUDE, MARKET_RANK  
                            FROM PONDER.SALES_OPP_MDU_PROD
                            WHERE COUNTY_FIPS = '{0}'
                            AND COUNTY_RANK <= 50
                            ORDER BY COUNTY_RANK, WIRELESS_SCORE DESC) WHERE ROWNUM <= 50" },
            { "ExportToExcel_TopMDUsZIP", @"SELECT * FROM (SELECT SALES_MARKET AS VPGM_MARKET, ZIP_RANK, ZIP, WIRELESS_SCORE, 
                            CASE WHEN WIRELESS_SCORE = 5 THEN 'Best'
                            WHEN WIRELESS_SCORE = 4 THEN 'Very Strong'
                            WHEN WIRELESS_SCORE = 3 THEN 'Strong'
                            WHEN WIRELESS_SCORE = 2 THEN 'Uneven'
                            WHEN WIRELESS_SCORE = 1 THEN 'Very Weak'
                            ELSE 'Not enough Samples' END AS WIRELESS_SCORE_TEXT, FIBER_AVAILABLE, FIBER_OPPORTUNITY, FIBER_PENETRATION_RATE, 
                            HOUSE_NUMBER, STREET_NAME, CITY, STATE, ZIP, LATITUDE, LONGITUDE
                            FROM PONDER.SALES_OPP_MDU_PROD TBL1
                            WHERE ZIP = '{0}'
                            AND ZIP_RANK <= 50
                            ORDER BY ZIP_RANK, WIRELESS_SCORE DESC" },
            //{ "ExportToExcel_MDUAddressesCMA", @"SELECT SALES_MARKET AS VPGM_MARKET, CMA, CMA_NAME, WIRELESS_PSA_SCORE AS WIRELESS_SCORE, 
            //                CASE WHEN WIRELESS_PSA_SCORE = 5 THEN 'Best'
            //                WHEN WIRELESS_PSA_SCORE = 4 THEN 'Very Strong'
            //                WHEN WIRELESS_PSA_SCORE = 3 THEN 'Strong'
            //                WHEN WIRELESS_PSA_SCORE = 2 THEN 'Uneven'
            //                WHEN WIRELESS_PSA_SCORE = 1 THEN 'Very Weak'
            //                ELSE 'Not enough Samples' END AS WIRELESS_SCORE_TEXT, 
            //                HOUSE_NUMBER, STREET_NAME, BUILDING_NUMBER, UNIT_NUMBER, CITY, ZIP, STATE, SERVICE_STATUS, DWELLING_TYPE, LATITUDE, LONGITUDE, MARKET_RANK, CMA_RANK
            //                FROM PONDER.SALES_OPP_MDU_ADDRESSES
            //                WHERE CMA = '{0}'
            //                AND CMA_RANK <= 50" },
            { "ExportToExcel_MDUAddressesCMA", @"SELECT TDATE.DATA_DATE, T1.SALES_MARKET AS VPGM_MARKET, T1.CMA, REPLACE(T1.CMA_NAME, ',', ' ') AS CMA_NAME, T1.ZIP_CO_PSA, T1.WIRELESS_SCORE,
                    CASE WHEN T1.WIRELESS_SCORE = 5 THEN 'Best'
                    WHEN T1.WIRELESS_SCORE = 4 THEN 'Very Strong'
                    WHEN T1.WIRELESS_SCORE = 3 THEN 'Strong'
                    WHEN T1.WIRELESS_SCORE = 2 THEN 'Uneven'
                    WHEN T1.WIRELESS_SCORE = 1 THEN 'Very Weak'
                    ELSE 'Not enough Samples' END AS WIRELESS_SCORE_TEXT,
                    T2.HOUSE_NUMBER, T2.PREFIX, T2.STREET_NAME, T2.BUILDING_NUMBER, T2.UNIT_NUMBER, 
                    T2.CITY, T2.ZIP, T2.STATE, CASE WHEN T2.DL_MAX_SPEED > 1 THEN 'Yes' ELSE 'No' END AS HYPERGIG, CASE WHEN REGREEN = 1 THEN 'Yes' ELSE 'No' END AS REGREEN, CASE WHEN ADSL = 1 THEN 'Yes' ELSE 'No' END AS ADSL, CASE WHEN CSI_ELIGIBLE = 1 THEN 'Yes' ELSE 'No' END AS CSI_ELIGIBLE,
                    CASE WHEN T2.SERVICE_STATUS = 'InService' THEN 'Customer' WHEN T2.SERVICE_STATUS IS NULL AND T2.BB_ALL = 1 AND T2.BB_FIBR = 0 THEN  'Upgrade' ELSE 'Prospect' END AS CUSTOMER,
                    T2.DWELLING_TYPE, T2.LATITUDE, T2.LONGITUDE, T1.CMA_RANK, T1.MARKET_RANK
                    FROM PONDER.SALES_OPP_MDU_PROD T1
                    LEFT JOIN PONDER.SALES_OPP_FIBER_ADDR T2
                    ON T1.ZIP = T2.ZIP AND T1.HOUSE_NUMBER = T2.HOUSE_NUMBER AND T1.PREFIX = T2.PREFIX AND T1.STREET_NAME = T2.STREET_NAME
                    LEFT JOIN (SELECT DATA_DATE FROM PONDER.SALES_OPP_DATA_INFO_TEST WHERE DATA_SOURCE = 'OVALS_Active_Fiber')TDATE
                    ON 1=1
                    WHERE T1.CMA = '{0}' AND T1.CMA_RANK <= 50
                    ORDER BY T1.CMA_RANK, T1.ZIP, T1.STREET_NAME, T1.PREFIX, T2.BUILDING_NUMBER, T2.UNIT_NUMBER" },
            //{ "ExportToExcel_MDUAddressesCounty", @"SELECT SALES_MARKET AS VPGM_MARKET, CMA, CMA_NAME, WIRELESS_PSA_SCORE AS WIRELESS_SCORE, 
            //                CASE WHEN WIRELESS_PSA_SCORE = 5 THEN 'Best'
            //                WHEN WIRELESS_PSA_SCORE = 4 THEN 'Very Strong'
            //                WHEN WIRELESS_PSA_SCORE = 3 THEN 'Strong'
            //                WHEN WIRELESS_PSA_SCORE = 2 THEN 'Uneven'
            //                WHEN WIRELESS_PSA_SCORE = 1 THEN 'Very Weak'
            //                ELSE 'Not enough Samples' END AS WIRELESS_SCORE_TEXT, 
            //                HOUSE_NUMBER, STREET_NAME, BUILDING_NUMBER, UNIT_NUMBER, CITY, ZIP, STATE, SERVICE_STATUS, DWELLING_TYPE, LATITUDE, LONGITUDE, MARKET_RANK, CMA_RANK
            //                FROM PONDER.SALES_OPP_MDU_ADDRESSES
            //                WHERE COUNTY_FIPS = '{0}'
            //                AND COUNTY_RANK <= 50" },
            { "ExportToExcel_MDUAddressesCounty", @"SELECT TDATE.DATA_DATE, T1.SALES_MARKET AS VPGM_MARKET, T1.COUNTY_FIPS, T1.ZIP_CO_PSA, T1.WIRELESS_SCORE,
                    CASE WHEN T1.WIRELESS_SCORE = 5 THEN 'Best'
                    WHEN T1.WIRELESS_SCORE = 4 THEN 'Very Strong'
                    WHEN T1.WIRELESS_SCORE = 3 THEN 'Strong'
                    WHEN T1.WIRELESS_SCORE = 2 THEN 'Uneven'
                    WHEN T1.WIRELESS_SCORE = 1 THEN 'Very Weak'
                    ELSE 'Not enough Samples' END AS WIRELESS_SCORE_TEXT,
                    T2.HOUSE_NUMBER, T2.PREFIX, T2.STREET_NAME, T2.BUILDING_NUMBER, T2.UNIT_NUMBER, 
                    T2.CITY, T2.ZIP, T2.STATE, CASE WHEN T2.DL_MAX_SPEED > 1 THEN 'Yes' ELSE 'No' END AS HYPERGIG, CASE WHEN REGREEN = 1 THEN 'Yes' ELSE 'No' END AS REGREEN, CASE WHEN ADSL = 1 THEN 'Yes' ELSE 'No' END AS ADSL, CASE WHEN CSI_ELIGIBLE = 1 THEN 'Yes' ELSE 'No' END AS CSI_ELIGIBLE,
                    CASE WHEN T2.SERVICE_STATUS = 'InService' THEN 'Customer' WHEN T2.SERVICE_STATUS IS NULL AND T2.BB_ALL = 1 AND T2.BB_FIBR = 0 THEN  'Upgrade' ELSE 'Prospect' END AS CUSTOMER, 
                    T2.DWELLING_TYPE, T2.LATITUDE, T2.LONGITUDE, T1.COUNTY_RANK, T1.MARKET_RANK
                    FROM PONDER.SALES_OPP_MDU_PROD T1
                    LEFT JOIN PONDER.SALES_OPP_FIBER_ADDR T2
                    ON T1.ZIP = T2.ZIP AND T1.HOUSE_NUMBER = T2.HOUSE_NUMBER AND T1.PREFIX = T2.PREFIX AND T1.STREET_NAME = T2.STREET_NAME
                    LEFT JOIN (SELECT DATA_DATE FROM PONDER.SALES_OPP_DATA_INFO_TEST WHERE DATA_SOURCE = 'OVALS_Active_Fiber')TDATE ON 1=1
                    WHERE T1.COUNTY_FIPS = '{0}' AND T1.COUNTY_RANK <= 50
                    ORDER BY T1.COUNTY_RANK, T1.ZIP, T1.STREET_NAME, T1.PREFIX, T2.BUILDING_NUMBER, T2.UNIT_NUMBER" },
            //{ "ExportToExcel_MDUAddressesZIP", @"SELECT SALES_MARKET AS VPGM_MARKET, CMA, CMA_NAME, WIRELESS_PSA_SCORE AS WIRELESS_SCORE, 
            //                CASE WHEN WIRELESS_PSA_SCORE = 5 THEN 'Best'
            //                WHEN WIRELESS_PSA_SCORE = 4 THEN 'Very Strong'
            //                WHEN WIRELESS_PSA_SCORE = 3 THEN 'Strong'
            //                WHEN WIRELESS_PSA_SCORE = 2 THEN 'Uneven'
            //                WHEN WIRELESS_PSA_SCORE = 1 THEN 'Very Weak'
            //                ELSE 'Not enough Samples' END AS WIRELESS_SCORE_TEXT, 
            //                HOUSE_NUMBER, STREET_NAME, BUILDING_NUMBER, UNIT_NUMBER, CITY, ZIP, STATE, SERVICE_STATUS, DWELLING_TYPE, LATITUDE, LONGITUDE, MARKET_RANK, CMA_RANK
            //                FROM PONDER.SALES_OPP_MDU_ADDRESSES
            //                WHERE ZIP = '{0}'
            //                AND ZIP_RANK <= 50" },
            { "ExportToExcel_MDUAddressesZIP", @"SELECT TDATE.DATA_DATE, T1.SALES_MARKET AS VPGM_MARKET, T1.ZIP_CO_PSA, T1.WIRELESS_SCORE,
                    CASE WHEN T1.WIRELESS_SCORE = 5 THEN 'Best'
                    WHEN T1.WIRELESS_SCORE = 4 THEN 'Very Strong'
                    WHEN T1.WIRELESS_SCORE = 3 THEN 'Strong'
                    WHEN T1.WIRELESS_SCORE = 2 THEN 'Uneven'
                    WHEN T1.WIRELESS_SCORE = 1 THEN 'Very Weak'
                    ELSE 'Not enough Samples' END AS WIRELESS_SCORE_TEXT,
                    T2.HOUSE_NUMBER, T2.PREFIX, T2.STREET_NAME, T2.BUILDING_NUMBER, T2.UNIT_NUMBER, 
                    T2.CITY, T2.ZIP, T2.STATE, CASE WHEN T2.DL_MAX_SPEED > 1 THEN 'Yes' ELSE 'No' END AS HYPERGIG, CASE WHEN REGREEN = 1 THEN 'Yes' ELSE 'No' END AS REGREEN, CASE WHEN ADSL = 1 THEN 'Yes' ELSE 'No' END AS ADSL, CASE WHEN CSI_ELIGIBLE = 1 THEN 'Yes' ELSE 'No' END AS CSI_ELIGIBLE,
                    CASE WHEN T2.SERVICE_STATUS = 'InService' THEN 'Customer' WHEN T2.SERVICE_STATUS IS NULL AND T2.BB_ALL = 1 AND T2.BB_FIBR = 0 THEN  'Upgrade' ELSE 'Prospect' END AS CUSTOMER, 
                    T2.DWELLING_TYPE, T2.LATITUDE, T2.LONGITUDE, T1.ZIP_RANK, T1.MARKET_RANK
                    FROM PONDER.SALES_OPP_MDU_PROD T1
                    LEFT JOIN PONDER.SALES_OPP_FIBER_ADDR T2
                    ON T1.ZIP = T2.ZIP AND T1.HOUSE_NUMBER = T2.HOUSE_NUMBER AND T1.PREFIX = T2.PREFIX AND T1.STREET_NAME = T2.STREET_NAME
                    LEFT JOIN (SELECT DATA_DATE FROM PONDER.SALES_OPP_DATA_INFO_TEST WHERE DATA_SOURCE = 'OVALS_Active_Fiber')TDATE ON 1=1
                    WHERE T1.ZIP = '{0}' AND T1.ZIP_RANK <= 50
                    ORDER BY T1.ZIP_RANK, T1.ZIP, T1.STREET_NAME, T1.PREFIX, T2.BUILDING_NUMBER, T2.UNIT_NUMBER" },
            { "ExportToExcel_SelectedMDUAddressesCMA", @"SELECT TDATE.DATA_DATE, T1.SALES_MARKET AS VPGM_MARKET, T1.CMA, REPLACE(T1.CMA_NAME, ',', ' ') AS CMA_NAME, T1.ZIP_CO_PSA, T1.WIRELESS_SCORE,
                CASE WHEN T1.WIRELESS_SCORE = 5 THEN 'Best'
                WHEN T1.WIRELESS_SCORE = 4 THEN 'Very Strong'
                WHEN T1.WIRELESS_SCORE = 3 THEN 'Strong'
                WHEN T1.WIRELESS_SCORE = 2 THEN 'Uneven'
                WHEN T1.WIRELESS_SCORE = 1 THEN 'Very Weak'
                ELSE 'Not enough Samples' END AS WIRELESS_SCORE_TEXT,
                T2.HOUSE_NUMBER, T2.PREFIX, T2.STREET_NAME, T2.BUILDING_NUMBER, T2.UNIT_NUMBER, 
                T2.CITY, T2.ZIP, T2.STATE, CASE WHEN T2.DL_MAX_SPEED > 1 THEN 'Yes' ELSE 'No' END AS HYPERGIG, CASE WHEN REGREEN = 1 THEN 'Yes' ELSE 'No' END AS REGREEN, CASE WHEN ADSL = 1 THEN 'Yes' ELSE 'No' END AS ADSL, CASE WHEN CSI_ELIGIBLE = 1 THEN 'Yes' ELSE 'No' END AS CSI_ELIGIBLE,
                CASE WHEN T2.SERVICE_STATUS = 'InService' THEN 'Customer' WHEN T2.SERVICE_STATUS IS NULL AND T2.BB_ALL = 1 AND T2.BB_FIBR = 0 THEN  'Upgrade' ELSE 'Prospect' END AS CUSTOMER,
                T2.DWELLING_TYPE, T2.LATITUDE, T2.LONGITUDE, T1.CMA_RANK, T1.MARKET_RANK
                FROM PONDER.SALES_OPP_MDU_PROD T1
                LEFT JOIN PONDER.SALES_OPP_FIBER_ADDR T2
                ON T1.ZIP = T2.ZIP AND T1.HOUSE_NUMBER = T2.HOUSE_NUMBER AND T1.PREFIX = T2.PREFIX AND T1.STREET_NAME = T2.STREET_NAME 
                LEFT JOIN (SELECT DATA_DATE FROM PONDER.SALES_OPP_DATA_INFO_TEST WHERE DATA_SOURCE = 'OVALS_Active_Fiber')TDATE ON 1=1
                WHERE T1.HOUSE_NUMBER = '{1}' AND T1.PREFIX = '{2}' AND T1.STREET_NAME = '{3}' AND T1.ZIP = '{4}'
                ORDER BY T1.ZIP, T1.STREET_NAME, T1.PREFIX, T2.BUILDING_NUMBER, T2.UNIT_NUMBER" },
            { "ExportToExcel_SelectedMDUAddressesCounty", @"SELECT TDATE.DATA_DATE, T1.SALES_MARKET AS VPGM_MARKET, T1.COUNTY_FIPS, T1.ZIP_CO_PSA, T1.WIRELESS_SCORE,
                CASE WHEN T1.WIRELESS_SCORE = 5 THEN 'Best'
                WHEN T1.WIRELESS_SCORE = 4 THEN 'Very Strong'
                WHEN T1.WIRELESS_SCORE = 3 THEN 'Strong'
                WHEN T1.WIRELESS_SCORE = 2 THEN 'Uneven'
                WHEN T1.WIRELESS_SCORE = 1 THEN 'Very Weak'
                ELSE 'Not enough Samples' END AS WIRELESS_SCORE_TEXT,
                T2.HOUSE_NUMBER, T2.PREFIX, T2.STREET_NAME, T2.BUILDING_NUMBER, T2.UNIT_NUMBER, 
                T2.CITY, T2.ZIP, T2.STATE, CASE WHEN T2.DL_MAX_SPEED > 1 THEN 'Yes' ELSE 'No' END AS HYPERGIG, CASE WHEN REGREEN = 1 THEN 'Yes' ELSE 'No' END AS REGREEN, CASE WHEN ADSL = 1 THEN 'Yes' ELSE 'No' END AS ADSL, CASE WHEN CSI_ELIGIBLE = 1 THEN 'Yes' ELSE 'No' END AS CSI_ELIGIBLE,
                CASE WHEN T2.SERVICE_STATUS = 'InService' THEN 'Customer' WHEN T2.SERVICE_STATUS IS NULL AND T2.BB_ALL = 1 AND T2.BB_FIBR = 0 THEN  'Upgrade' ELSE 'Prospect' END AS CUSTOMER, 
                T2.DWELLING_TYPE, T2.LATITUDE, T2.LONGITUDE, T1.COUNTY_RANK, T1.MARKET_RANK
                FROM PONDER.SALES_OPP_MDU_PROD T1
                LEFT JOIN PONDER.SALES_OPP_FIBER_ADDR T2
                ON T1.ZIP = T2.ZIP AND T1.HOUSE_NUMBER = T2.HOUSE_NUMBER AND T1.PREFIX = T2.PREFIX AND T1.STREET_NAME = T2.STREET_NAME
                LEFT JOIN (SELECT DATA_DATE FROM PONDER.SALES_OPP_DATA_INFO_TEST WHERE DATA_SOURCE = 'OVALS_Active_Fiber')TDATE ON 1=1
                WHERE T1.HOUSE_NUMBER = '{1}' AND T1.PREFIX = '{2}' AND T1.STREET_NAME = '{3}' AND T1.ZIP = '{4}'
                ORDER BY T1.ZIP, T1.STREET_NAME, T1.PREFIX, T2.BUILDING_NUMBER, T2.UNIT_NUMBER" },
            { "ExportToExcel_SelectedMDUAddressesZIP", @"SELECT TDATE.DATA_DATE, T1.SALES_MARKET AS VPGM_MARKET, T1.ZIP_CO_PSA, T1.WIRELESS_SCORE,
                CASE WHEN T1.WIRELESS_SCORE = 5 THEN 'Best'
                WHEN T1.WIRELESS_SCORE = 4 THEN 'Very Strong'
                WHEN T1.WIRELESS_SCORE = 3 THEN 'Strong'
                WHEN T1.WIRELESS_SCORE = 2 THEN 'Uneven'
                WHEN T1.WIRELESS_SCORE = 1 THEN 'Very Weak'
                ELSE 'Not enough Samples' END AS WIRELESS_SCORE_TEXT,
                T2.HOUSE_NUMBER, T2.PREFIX, T2.STREET_NAME, T2.BUILDING_NUMBER, T2.UNIT_NUMBER, 
                T2.CITY, T2.ZIP, T2.STATE, CASE WHEN T2.DL_MAX_SPEED > 1 THEN 'Yes' ELSE 'No' END AS HYPERGIG, CASE WHEN REGREEN = 1 THEN 'Yes' ELSE 'No' END AS REGREEN, CASE WHEN ADSL = 1 THEN 'Yes' ELSE 'No' END AS ADSL, CASE WHEN CSI_ELIGIBLE = 1 THEN 'Yes' ELSE 'No' END AS CSI_ELIGIBLE,
                CASE WHEN T2.SERVICE_STATUS = 'InService' THEN 'Customer' WHEN T2.SERVICE_STATUS IS NULL AND T2.BB_ALL = 1 AND T2.BB_FIBR = 0 THEN  'Upgrade' ELSE 'Prospect' END AS CUSTOMER,
                T2.DWELLING_TYPE, T2.LATITUDE, T2.LONGITUDE, T1.ZIP_RANK, T1.MARKET_RANK
                FROM PONDER.SALES_OPP_MDU_PROD T1
                LEFT JOIN PONDER.SALES_OPP_FIBER_ADDR T2
                ON T1.ZIP = T2.ZIP AND T1.HOUSE_NUMBER = T2.HOUSE_NUMBER AND T1.PREFIX = T2.PREFIX AND T1.STREET_NAME = T2.STREET_NAME
                LEFT JOIN (SELECT DATA_DATE FROM PONDER.SALES_OPP_DATA_INFO_TEST WHERE DATA_SOURCE = 'OVALS_Active_Fiber')TDATE ON 1=1
                WHERE T1.HOUSE_NUMBER = '{1}' AND T1.PREFIX = '{2}' AND T1.STREET_NAME = '{3}' AND T1.ZIP = '{4}'
                ORDER BY T1.ZIP, T1.STREET_NAME, T1.PREFIX, T2.BUILDING_NUMBER, T2.UNIT_NUMBER" },
            { "ExportToExcel_AllCMAs", @"SELECT REPLACE(CMA_NAME, ',') AS CMA_NAME, CMA, WIRELESS_CATEGORY AS WIRELESS, FIBER_AVAILABILITY AS FIBER, FIBER_AVAILABLE, FIBER_CUSTOMERS, 
                                FIBER_PERCENTAGE, FIBER_OPPORTUNITY  
                                FROM PONDER.SALES_OPP_CMA_PROD WHERE SALES_REGION1 LIKE '{0}' OR SALES_REGION2 LIKE '{0}' OR SALES_MARKET1 LIKE '{0}' OR SALES_MARKET2 LIKE '{0}' OR SALES_MARKET3 LIKE '{0}'
                                ORDER BY {2} " },
            { "ExportToExcel_AllCounties", @"SELECT REPLACE(COUNTY_STATE, ',') AS COUNTY, CNTY_FIPS, SALES_MARKET, SALES_REGION,
                                WIRELESS_CATEGORY, FIBER_AVAILABILITY AS FIBER,  FIBER_AVAILABLE, FIBER_CUSTOMERS, FIBER_PERCENTAGE, FIBER_OPPORTUNITY
                                FROM PONDER.SALES_OPP_COUNTY_PROD
                                WHERE {1} LIKE '{0}' ORDER BY {2} " },
            { "ExportToExcel_AllZips", @"SELECT ZIP, STATE, SALES_MARKET, SALES_REGION,  WIRELESS_CATEGORY, FIBER_AVAILABILITY AS FIBER,
                                FIBER_AVAILABLE, FIBER_CUSTOMERS, FIBER_PERCENTAGE, FIBER_OPPORTUNITY
                                FROM PONDER.SALES_OPP_ZIP_PROD WHERE SALES_MARKET = '{0}' AND TOTALAREA > 0.2
                                ORDER BY {1} " },
        };

        public static Dictionary<string, string> DATA_QUERY_DICTIONARY = new Dictionary<string, string>
        {
            {"Get_Store_Detail_Market", @"SELECT STORE_CATEGORY, LOCATION_ID, LOCATION_NAME, MASTER_DEALER, ADDRESS_1, ADDRESS_2, CITY, STATE, ZIP_CODE, COUNTY, LATITUDE, LONGITUDE, REGION AS SALES_REGION, MARKET_GROUP AS SALES_VPGM_MARKET
                                FROM (SELECT STORE_CATEGORY, LOCATION_ID, LOCATION_NAME, MASTER_DEALER, ADDRESS_1, ADDRESS_2, CITY, STATE, ZIP_CODE, COUNTY, LATITUDE, LONGITUDE, REGION, MARKET_GROUP, ROWNUM ROW_NUM
                                FROM PONDER.SALES_ATT_STORE_LOC_PROD
                                WHERE (MARKET_GROUP LIKE '{0}'))" },
            {"Get_Zip_Summary_Info", @"SELECT
                                  'ZIP_SUMMARY' AS CATEGORY,
                                  SUM(CASE WHEN OVERALL_CAT = 'WeakWirelessNoFiber' THEN 1 ELSE 0 END) AS PWNF_COUNT,
                                  SUM(CASE WHEN OVERALL_CAT = 'WeakWirelessNoFiber' THEN FIBER_OPPORTUNITY ELSE 0 END) AS PWNF_OPP,
                                  SUM(CASE WHEN OVERALL_CAT = 'WeakWirelessFiberAvailable' THEN 1 ELSE 0 END) AS PWGF_COUNT,
                                  SUM(CASE WHEN OVERALL_CAT = 'WeakWirelessFiberAvailable' THEN FIBER_OPPORTUNITY ELSE 0 END) AS PWGF_OPP,
                                  SUM(CASE WHEN OVERALL_CAT = 'StrongWirelessNoFiber' THEN 1 ELSE 0 END) AS GWNF_COUNT,
                                  SUM(CASE WHEN OVERALL_CAT = 'StrongWirelessNoFiber' THEN FIBER_OPPORTUNITY ELSE 0 END) AS GWNF_OPP,
                                  SUM(CASE WHEN OVERALL_CAT = 'StrongWirelessFiberAvailable' THEN 1 ELSE 0 END) AS GWGF_COUNT,
                                  SUM(CASE WHEN OVERALL_CAT = 'StrongWirelessFiberAvailable' THEN FIBER_OPPORTUNITY ELSE 0 END) AS GWGF_OPP,
                                  SUM(CASE WHEN FIBER_AVAILABLE = 0 THEN 1 ELSE 0 END) AS NO_FIBER_COUNT,
                                  SUM(CASE WHEN FIBER_AVAILABLE > 0 AND FIBER_PERCENTAGE < 30 THEN 1 ELSE 0 END) AS LOW_PEN_COUNT,
                                  SUM(CASE WHEN FIBER_AVAILABLE > 0 AND FIBER_PERCENTAGE < 40 AND FIBER_PERCENTAGE >= 30 THEN 1 ELSE 0 END) AS MED_PEN_COUNT,
                                  SUM(CASE WHEN FIBER_AVAILABLE > 0 AND FIBER_PERCENTAGE >= 40 THEN 1 ELSE 0 END) AS HIGH_PEN_COUNT,
                                  SUM(CASE WHEN FIBER_AVAILABLE = 0 THEN FIBER_OPPORTUNITY ELSE 0 END) AS NO_FIBER_OPP,
                                    SUM(CASE WHEN FIBER_AVAILABLE > 0 AND FIBER_PERCENTAGE < 30 THEN FIBER_OPPORTUNITY ELSE 0 END) AS LOW_PEN_OPP,
                                    SUM(CASE WHEN FIBER_AVAILABLE > 0 AND FIBER_PERCENTAGE < 40 AND FIBER_PERCENTAGE >= 30 THEN FIBER_OPPORTUNITY ELSE 0 END) AS MED_PEN_OPP,
                                    SUM(CASE WHEN FIBER_AVAILABLE > 0 AND FIBER_PERCENTAGE >= 40 THEN FIBER_OPPORTUNITY ELSE 0 END) AS HIGH_PEN_OPP,
                                  SUM(CASE WHEN FIBER_AVAILABLE > 0 AND ELDERLY_PERCENT < 20 THEN 1 ELSE 0 END) AS LOW_ELDERLY_COUNT,
                                  SUM(CASE WHEN FIBER_AVAILABLE > 0 AND ELDERLY_PERCENT < 25 AND ELDERLY_PERCENT >= 20 THEN 1 ELSE 0 END) AS MED_ELDERLY_COUNT,
                                  SUM(CASE WHEN FIBER_AVAILABLE > 0 AND ELDERLY_PERCENT >= 25 THEN 1 ELSE 0 END) AS HIGH_ELDERLY_COUNT,
                                  SUM(CASE WHEN FIBER_AVAILABLE > 0 AND ELDERLY_PERCENT < 20 THEN FIBER_OPPORTUNITY ELSE 0 END) AS LOW_ELDERLY_OPP,
                                    SUM(CASE WHEN FIBER_AVAILABLE > 0 AND ELDERLY_PERCENT < 25 AND ELDERLY_PERCENT >= 20 THEN FIBER_OPPORTUNITY ELSE 0 END) AS MED_ELDERLY_OPP,
                                    SUM(CASE WHEN FIBER_AVAILABLE > 0 AND ELDERLY_PERCENT >= 25 THEN FIBER_OPPORTUNITY ELSE 0 END) AS HIGH_ELDERLY_OPP
                                  FROM PONDER.SALES_OPP_ZIP_PROD
                                  WHERE SALES_MARKET LIKE '{0}' AND OVERALL_CAT != 'No Category' AND TOTALAREA > 0.2" },
            {"Get_ZipTable_Data", @"SELECT TDATE.DATA_DATE, ROWNUM, TBL1.*, CASE WHEN TO_NUMBER(FIBER_AVAILABLE, '999,999,999,999') > 0 THEN 1 ELSE 0 END AS FIBER_AVAILABLE_SORT_VALUE FROM(SELECT TO_CHAR(COPPER_UPGRADE + 0, '999,999,999,999') AS COPPER_UPGRADE, ZIP, ROUND(TOTALAREA,0) AS TOTALAREA, TO_CHAR(TOTALPOPS + 0, '999,999,999,999') AS TOTALPOPS, TO_CHAR(POP_DENSITY + 0, '999,999,999.9') AS POP_DENSITY, 
                                WIRELESS_SCORE, FIBER_SCORE, TO_CHAR(FIBER_AVAILABLE, '999,999,999,999') AS FIBER_AVAILABLE, TO_CHAR(FIBER_CUSTOMERS, '999,999,999,999') AS FIBER_CUSTOMERS, FIBER_PERCENTAGE, CONCAT(FIBER_PERCENTAGE,'%') AS FIBER_PERCENTAGE_TEXT, OVERALL_CAT, TO_CHAR(FIBER_OPPORTUNITY, 
                                '999,999,999,999') AS FIBER_OPPORTUNITY, NUMBER_OF_PSAS, WIRELESS_CATEGORY, FIBER_AVAILABILITY, ATTR_STORE_COUNT, AR_STORE_COUNT, ALL_STORE_COUNT, ELDERLY_PERCENT, CONCAT(ELDERLY_PERCENT,'%') AS ELDERLY_PERCENT_TEXT 
                                FROM PONDER.SALES_OPP_ZIP_PROD WHERE SALES_MARKET = '{0}' {1}
                                AND OVERALL_CAT != 'No Category' AND TOTALAREA > 0.2 ORDER BY {2})TBL1
                                LEFT JOIN (SELECT DATA_DATE FROM PONDER.SALES_OPP_DATA_INFO_TEST WHERE DATA_SOURCE = 'OVALS_Active_Fiber')TDATE ON 1=1" },
            {"Get_Store_Detail_Region",@"SELECT STORE_CATEGORY, LOCATION_ID, LOCATION_NAME, MASTER_DEALER, ADDRESS_1, ADDRESS_2, CITY, STATE, ZIP_CODE, COUNTY, LATITUDE, LONGITUDE, REGION AS SALES_REGION, MARKET_GROUP AS SALES_VPGM_MARKET
                                FROM (SELECT STORE_CATEGORY, LOCATION_ID, LOCATION_NAME, MASTER_DEALER, ADDRESS_1, ADDRESS_2, CITY, STATE, ZIP_CODE, COUNTY, LATITUDE, LONGITUDE, REGION, MARKET_GROUP, ROWNUM ROW_NUM
                                FROM PONDER.SALES_ATT_STORE_LOC_PROD
                                WHERE (REGION LIKE '{0}'))" },
            {"Get_County_Summary_Info", @"SELECT 'COUNTY_SUMMARY' AS CATEGORY,
                                  SUM(CASE WHEN OVERALL_CAT = 'WeakWirelessNoFiber' THEN 1 ELSE 0 END) AS PWNF_COUNT,
                                  SUM(CASE WHEN OVERALL_CAT = 'WeakWirelessNoFiber' THEN FIBER_OPPORTUNITY ELSE 0 END) AS PWNF_OPP,
                                  SUM(CASE WHEN OVERALL_CAT = 'WeakWirelessFiberAvailable' THEN 1 ELSE 0 END) AS PWGF_COUNT,
                                  SUM(CASE WHEN OVERALL_CAT = 'WeakWirelessFiberAvailable' THEN FIBER_OPPORTUNITY ELSE 0 END) AS PWGF_OPP,
                                  SUM(CASE WHEN OVERALL_CAT = 'StrongWirelessNoFiber' THEN 1 ELSE 0 END) AS GWNF_COUNT,
                                  SUM(CASE WHEN OVERALL_CAT = 'StrongWirelessNoFiber' THEN FIBER_OPPORTUNITY ELSE 0 END) AS GWNF_OPP,
                                  SUM(CASE WHEN OVERALL_CAT = 'StrongWirelessFiberAvailable' THEN 1 ELSE 0 END) AS GWGF_COUNT,
                                  SUM(CASE WHEN OVERALL_CAT = 'StrongWirelessFiberAvailable' THEN FIBER_OPPORTUNITY ELSE 0 END) AS GWGF_OPP,
                                  SUM(CASE WHEN FIBER_AVAILABLE = 0 THEN 1 ELSE 0 END) AS NO_FIBER_COUNT,
                                  SUM(CASE WHEN FIBER_AVAILABLE > 0 AND FIBER_PERCENTAGE < 30 THEN 1 ELSE 0 END) AS LOW_PEN_COUNT,
                                  SUM(CASE WHEN FIBER_AVAILABLE > 0 AND FIBER_PERCENTAGE < 40 AND FIBER_PERCENTAGE >= 30 THEN 1 ELSE 0 END) AS MED_PEN_COUNT,
                                  SUM(CASE WHEN FIBER_AVAILABLE > 0 AND FIBER_PERCENTAGE >= 40 THEN 1 ELSE 0 END) AS HIGH_PEN_COUNT,
                                  SUM(CASE WHEN FIBER_AVAILABLE = 0 THEN FIBER_OPPORTUNITY ELSE 0 END) AS NO_FIBER_OPP,
                                    SUM(CASE WHEN FIBER_AVAILABLE > 0 AND FIBER_PERCENTAGE < 30 THEN FIBER_OPPORTUNITY ELSE 0 END) AS LOW_PEN_OPP,
                                    SUM(CASE WHEN FIBER_AVAILABLE > 0 AND FIBER_PERCENTAGE < 40 AND FIBER_PERCENTAGE >= 30 THEN FIBER_OPPORTUNITY ELSE 0 END) AS MED_PEN_OPP,
                                    SUM(CASE WHEN FIBER_AVAILABLE > 0 AND FIBER_PERCENTAGE >= 40 THEN FIBER_OPPORTUNITY ELSE 0 END) AS HIGH_PEN_OPP,
                                  SUM(CASE WHEN FIBER_AVAILABLE > 0 AND ELDERLY_PERCENT < 20 THEN 1 ELSE 0 END) AS LOW_ELDERLY_COUNT,
                                  SUM(CASE WHEN FIBER_AVAILABLE > 0 AND ELDERLY_PERCENT < 25 AND ELDERLY_PERCENT >= 20 THEN 1 ELSE 0 END) AS MED_ELDERLY_COUNT,
                                  SUM(CASE WHEN FIBER_AVAILABLE > 0 AND ELDERLY_PERCENT >= 25 THEN 1 ELSE 0 END) AS HIGH_ELDERLY_COUNT,
                                  SUM(CASE WHEN FIBER_AVAILABLE > 0 AND ELDERLY_PERCENT < 20 THEN FIBER_OPPORTUNITY ELSE 0 END) AS LOW_ELDERLY_OPP,
                                    SUM(CASE WHEN FIBER_AVAILABLE > 0 AND ELDERLY_PERCENT < 25 AND ELDERLY_PERCENT >= 20 THEN FIBER_OPPORTUNITY ELSE 0 END) AS MED_ELDERLY_OPP,
                                    SUM(CASE WHEN FIBER_AVAILABLE > 0 AND ELDERLY_PERCENT >= 25 THEN FIBER_OPPORTUNITY ELSE 0 END) AS HIGH_ELDERLY_OPP
                                  FROM PONDER.SALES_OPP_COUNTY_PROD
                                  WHERE {0} LIKE '{1}'" },
            {"Get_CountyTable_Data",@"SELECT TDATE.DATA_DATE, ROWNUM, TBL1.*, CASE WHEN TO_NUMBER(FIBER_AVAILABLE, '999,999,999,999') > 0 THEN 1 ELSE 0 END AS FIBER_AVAILABLE_SORT_VALUE FROM(SELECT TO_CHAR(COPPER_UPGRADE + 0, '999,999,999,999') AS COPPER_UPGRADE, SMARTLABEL AS COUNTY, ROUND(TOTALAREA,0) AS TOTALAREA, TO_CHAR(TOTALPOPS + 0, '999,999,999,999') AS TOTALPOPS, TO_CHAR(POP_DENSITY + 0, '999,999,999.9') AS POP_DENSITY, 
                                WIRELESS_SCORE, FIBER_SCORE, TO_CHAR(FIBER_AVAILABLE, '999,999,999,999') AS FIBER_AVAILABLE, TO_CHAR(FIBER_CUSTOMERS, '999,999,999,999') AS FIBER_CUSTOMERS, FIBER_PERCENTAGE, CONCAT(FIBER_PERCENTAGE,'%') AS FIBER_PERCENTAGE_TEXT, OVERALL_CAT, COUNTY_STATE, 
                                TO_CHAR(FIBER_OPPORTUNITY, '999,999,999,999') AS FIBER_OPPORTUNITY, NUMBER_OF_PSAS, WIRELESS_CATEGORY, FIBER_AVAILABILITY, ATTR_STORE_COUNT, AR_STORE_COUNT, ALL_STORE_COUNT, ELDERLY_PERCENT, CONCAT(ELDERLY_PERCENT,'%') AS ELDERLY_PERCENT_TEXT 
                                FROM PONDER.SALES_OPP_COUNTY_PROD 
                                WHERE {0} LIKE '{1}' {2}
                                AND OVERALL_CAT != 'No Category' 
                                ORDER BY {3} )TBL1
                                LEFT JOIN (SELECT DATA_DATE FROM PONDER.SALES_OPP_DATA_INFO_TEST WHERE DATA_SOURCE = 'OVALS_Active_Fiber')TDATE ON 1=1" },
            {"Get_Store_Detail_National",@"SELECT STORE_CATEGORY, LOCATION_ID, LOCATION_NAME, MASTER_DEALER, ADDRESS_1, ADDRESS_2, CITY, STATE, ZIP_CODE, COUNTY, LATITUDE, LONGITUDE, REGION AS SALES_REGION, MARKET_GROUP AS SALES_VPGM_MARKET
                                FROM (SELECT STORE_CATEGORY, LOCATION_ID, LOCATION_NAME, MASTER_DEALER, ADDRESS_1, ADDRESS_2, CITY, STATE, ZIP_CODE, COUNTY, LATITUDE, LONGITUDE, REGION, MARKET_GROUP, ROWNUM ROW_NUM
                                FROM PONDER.SALES_ATT_STORE_LOC_PROD)" },
            {"Get_CMA_Summary_Info",@"SELECT
                                  'CMA_SUMMARY' AS CATEGORY,
                                  SUM(CASE WHEN OVERALL_CAT = 'WeakWirelessNoFiber' THEN 1 ELSE 0 END) AS PWNF_COUNT,
                                  SUM(CASE WHEN OVERALL_CAT = 'WeakWirelessNoFiber' THEN FIBER_OPPORTUNITY ELSE 0 END) AS PWNF_OPP,
                                  SUM(CASE WHEN OVERALL_CAT = 'WeakWirelessFiberAvailable' THEN 1 ELSE 0 END) AS PWGF_COUNT,
                                  SUM(CASE WHEN OVERALL_CAT = 'WeakWirelessFiberAvailable' THEN FIBER_OPPORTUNITY ELSE 0 END) AS PWGF_OPP,
                                  SUM(CASE WHEN OVERALL_CAT = 'StrongWirelessNoFiber' THEN 1 ELSE 0 END) AS GWNF_COUNT,
                                  SUM(CASE WHEN OVERALL_CAT = 'StrongWirelessNoFiber' THEN FIBER_OPPORTUNITY ELSE 0 END) AS GWNF_OPP,
                                  SUM(CASE WHEN OVERALL_CAT = 'StrongWirelessFiberAvailable' THEN 1 ELSE 0 END) AS GWGF_COUNT,
                                  SUM(CASE WHEN OVERALL_CAT = 'StrongWirelessFiberAvailable' THEN FIBER_OPPORTUNITY ELSE 0 END) AS GWGF_OPP,
                                  SUM(CASE WHEN FIBER_AVAILABLE = 0 THEN 1 ELSE 0 END) AS NO_FIBER_COUNT,
                                  SUM(CASE WHEN FIBER_AVAILABLE > 0 AND FIBER_PERCENTAGE < 30 THEN 1 ELSE 0 END) AS LOW_PEN_COUNT,
                                  SUM(CASE WHEN FIBER_AVAILABLE > 0 AND FIBER_PERCENTAGE < 40 AND FIBER_PERCENTAGE >= 30 THEN 1 ELSE 0 END) AS MED_PEN_COUNT,
                                  SUM(CASE WHEN FIBER_AVAILABLE > 0 AND FIBER_PERCENTAGE >= 40 THEN 1 ELSE 0 END) AS HIGH_PEN_COUNT,
                                  SUM(CASE WHEN FIBER_AVAILABLE = 0 THEN FIBER_OPPORTUNITY ELSE 0 END) AS NO_FIBER_OPP,
                                    SUM(CASE WHEN FIBER_AVAILABLE > 0 AND FIBER_PERCENTAGE < 30 THEN FIBER_OPPORTUNITY ELSE 0 END) AS LOW_PEN_OPP,
                                    SUM(CASE WHEN FIBER_AVAILABLE > 0 AND FIBER_PERCENTAGE < 40 AND FIBER_PERCENTAGE >= 30 THEN FIBER_OPPORTUNITY ELSE 0 END) AS MED_PEN_OPP,
                                    SUM(CASE WHEN FIBER_AVAILABLE > 0 AND FIBER_PERCENTAGE >= 40 THEN FIBER_OPPORTUNITY ELSE 0 END) AS HIGH_PEN_OPP,
                                  SUM(CASE WHEN FIBER_AVAILABLE > 0 AND ELDERLY_PERCENT < 20 THEN 1 ELSE 0 END) AS LOW_ELDERLY_COUNT,
                                  SUM(CASE WHEN FIBER_AVAILABLE > 0 AND ELDERLY_PERCENT < 25 AND ELDERLY_PERCENT >= 20 THEN 1 ELSE 0 END) AS MED_ELDERLY_COUNT,
                                  SUM(CASE WHEN FIBER_AVAILABLE > 0 AND ELDERLY_PERCENT >= 25 THEN 1 ELSE 0 END) AS HIGH_ELDERLY_COUNT,
                                  SUM(CASE WHEN FIBER_AVAILABLE > 0 AND ELDERLY_PERCENT < 20 THEN FIBER_OPPORTUNITY ELSE 0 END) AS LOW_ELDERLY_OPP,
                                    SUM(CASE WHEN FIBER_AVAILABLE > 0 AND ELDERLY_PERCENT < 25 AND ELDERLY_PERCENT >= 20 THEN FIBER_OPPORTUNITY ELSE 0 END) AS MED_ELDERLY_OPP,
                                    SUM(CASE WHEN FIBER_AVAILABLE > 0 AND ELDERLY_PERCENT >= 25 THEN FIBER_OPPORTUNITY ELSE 0 END) AS HIGH_ELDERLY_OPP
                                  FROM PONDER.SALES_OPP_CMA_PROD
                                  WHERE ({0}1 LIKE '{1}' OR {2}2 LIKE '{3}')" },
            {"Get_CMATable_Data", @"SELECT TDATE.DATA_DATE, ROWNUM, TBL1.*, CASE WHEN TO_NUMBER(FIBER_AVAILABLE, '999,999,999,999') > 0 THEN 1 ELSE 0 END AS FIBER_AVAILABLE_SORT_VALUE FROM(SELECT TO_CHAR(COPPER_UPGRADE + 0, '999,999,999,999') AS COPPER_UPGRADE, CMA, CMA_NAME, ROUND(TOTALAREA,0) AS TOTALAREA, TO_CHAR(TOTALPOPS + 0, '999,999,999,999') AS TOTALPOPS, TO_CHAR(POP_DENSITY + 0, '999,999,999.9') AS POP_DENSITY, 
                                    WIRELESS_SCORE, FIBER_SCORE, TO_CHAR(FIBER_AVAILABLE, '999,999,999,999') AS FIBER_AVAILABLE, TO_CHAR(FIBER_CUSTOMERS, '999,999,999,999') AS FIBER_CUSTOMERS, FIBER_PERCENTAGE, CONCAT(FIBER_PERCENTAGE,'%') AS FIBER_PERCENTAGE_TEXT, OVERALL_CAT, TO_CHAR(FIBER_OPPORTUNITY, 
                                    '999,999,999,999') AS FIBER_OPPORTUNITY, NUMBER_OF_PSAS, WIRELESS_CATEGORY, FIBER_AVAILABILITY, ATTR_STORE_COUNT, AR_STORE_COUNT, ALL_STORE_COUNT, ELDERLY_PERCENT, CONCAT(ELDERLY_PERCENT,'%') AS ELDERLY_PERCENT_TEXT FROM PONDER.SALES_OPP_CMA_PROD WHERE OVERALL_CAT != 'No Category' {0} 
                                     AND  ({1}1 LIKE '{2}' OR {3}2 LIKE '{4}')
                                    ORDER BY {5} )TBL1
                                    LEFT JOIN (SELECT DATA_DATE FROM PONDER.SALES_OPP_DATA_INFO_TEST WHERE DATA_SOURCE = 'OVALS_Active_Fiber')TDATE ON 1=1" },
            {"Get_ZipModalTable_Data",@"SELECT COPPER_UPGRADE, ZIP_RANK, ZIP_CO_PSA, ZIP, CO, PSA, 
                                    WIRELESS_SCORE, TO_CHAR(FIBER_AVAILABLE, '999,999,999,999') AS FIBER_AVAILABLE, TO_CHAR(FIBER_CUSTOMERS, '999,999,999,999') AS FIBER_CUSTOMERS, 
                                    TO_CHAR(FIBER_OPPORTUNITY, '999,999,999,999') AS FIBER_OPPORTUNITY, CONCAT(TO_CHAR((FIBER_CUSTOMERS*100/FIBER_AVAILABLE),'FM99990.0'),'%') AS FIBER_PENETRATION_RATE, 
                                    ROUND((FIBER_CUSTOMERS/FIBER_AVAILABLE),2) AS FIBER_PEN_SORT, WIRELESS_CATEGORY, LATITUDE, LONGITUDE,
                                    CASE WHEN WIRELESS_SCORE = 5 THEN '5 (Best)'
                                    WHEN WIRELESS_SCORE = 4 THEN '4 (Very Strong)'
                                    WHEN WIRELESS_SCORE = 3 THEN '3 (Strong)'
                                    WHEN WIRELESS_SCORE = 2 THEN '2 (Uneven)'
                                    WHEN WIRELESS_SCORE = 1 THEN '1 (Very Weak)'
                                    ELSE 'Not enough Samples' END AS WIRELESS_SCORE_TEXT
                                    FROM PONDER.SALES_OPP_PSA_PROD WHERE ZIP = '{0}'  
                                    ORDER BY ZIP_RANK, FIBER_OPPORTUNITY DESC" },
            {"Get_CMAModalTable_Data", @"SELECT * FROM (SELECT COPPER_UPGRADE, ZIP_CO_PSA, ZIP, CO, PSA,
                                    TO_CHAR(FIBER_AVAILABLE, '999,999,999,999') AS FIBER_AVAILABLE, TO_CHAR(FIBER_CUSTOMERS, '999,999,999,999') AS FIBER_CUSTOMERS,
                                    TO_CHAR(FIBER_OPPORTUNITY, '999,999,999,999') AS FIBER_OPPORTUNITY, CONCAT(TO_CHAR((FIBER_CUSTOMERS*100/FIBER_AVAILABLE),'FM99990.0'),'%') AS FIBER_PENETRATION_RATE, WIRELESS_CATEGORY, LATITUDE, LONGITUDE,
                                    CASE WHEN WIRELESS_SCORE = 5 THEN '5 (Best)'
                                    WHEN WIRELESS_SCORE = 4 THEN '4 (Very Strong)'
                                    WHEN WIRELESS_SCORE = 3 THEN '3 (Strong)'
                                    WHEN WIRELESS_SCORE = 2 THEN '2 (Uneven)'
                                    WHEN WIRELESS_SCORE = 1 THEN '1 (Very Weak)'
                                    ELSE 'Not enough Samples' END AS WIRELESS_SCORE_TEXT
                                    FROM PONDER.SALES_OPP_PSA_PROD
                                    WHERE CMA LIKE '{0}'
                                    AND CMA_RANK <= 25
                                    ORDER BY CMA_RANK) WHERE ROWNUM <= 25" },
            {"Get_CountyModalTable_Data",@"SELECT * FROM (SELECT COPPER_UPGRADE, ZIP_CO_PSA, ZIP, CO, PSA,
                                    TO_CHAR(FIBER_AVAILABLE, '999,999,999,999') AS FIBER_AVAILABLE, TO_CHAR(FIBER_CUSTOMERS, '999,999,999,999') AS FIBER_CUSTOMERS, 
                                    TO_CHAR(FIBER_OPPORTUNITY, '999,999,999,999') AS FIBER_OPPORTUNITY, CONCAT(TO_CHAR((FIBER_CUSTOMERS*100/FIBER_AVAILABLE),'FM99990.0'),'%') AS FIBER_PENETRATION_RATE, WIRELESS_CATEGORY, LATITUDE, LONGITUDE,
                                    CASE WHEN WIRELESS_SCORE = 5 THEN '5 (Best)'
                                    WHEN WIRELESS_SCORE = 4 THEN '4 (Very Strong)'
                                    WHEN WIRELESS_SCORE = 3 THEN '3 (Strong)'
                                    WHEN WIRELESS_SCORE = 2 THEN '2 (Uneven)'
                                    WHEN WIRELESS_SCORE = 1 THEN '1 (Very Weak)'
                                    ELSE 'Not enough Samples' END AS WIRELESS_SCORE_TEXT
                                    FROM PONDER.SALES_OPP_PSA_PROD
                                    WHERE COUNTY_FIPS LIKE '{0}'
                                    AND COUNTY_RANK <= 25
                                    ORDER BY COUNTY_RANK) WHERE ROWNUM <= 25" },
            {"Get_cma_theme_data_national",@"SELECT COPPER_UPGRADE, CMA, TOTALAREA, TOTALPOPS, POP_DENSITY, WIRELESS_SCORE, FIBER_SCORE, FIBER_AVAILABLE, FIBER_CUSTOMERS, FIBER_PERCENTAGE, OVERALL_CAT,
                                    FIBER_OPPORTUNITY, NUMBER_OF_PSAS, WIRELESS_CATEGORY, FIBER_AVAILABILITY, ATTR_STORE_COUNT, AR_STORE_COUNT, ALL_STORE_COUNT, SALES_MARKET, ELDERLY_PERCENT
                                    FROM PONDER.SALES_OPP_CMA_PROD" },
            {"Get_cma_theme_data_region",@"SELECT COPPER_UPGRADE, CMA, TOTALAREA, TOTALPOPS, POP_DENSITY, WIRELESS_SCORE, FIBER_SCORE, FIBER_AVAILABLE, FIBER_CUSTOMERS, FIBER_PERCENTAGE, OVERALL_CAT,
                                    FIBER_OPPORTUNITY, NUMBER_OF_PSAS, WIRELESS_CATEGORY, FIBER_AVAILABILITY, ATTR_STORE_COUNT, AR_STORE_COUNT, ALL_STORE_COUNT, SALES_MARKET, ELDERLY_PERCENT
                                    FROM PONDER.SALES_OPP_CMA_PROD WHERE SALES_REGION1 = '{0}' OR SALES_REGION2 = '{1}'" },
            {"Get_cma_theme_data_default",@"SELECT COPPER_UPGRADE, CMA, TOTALAREA, TOTALPOPS, POP_DENSITY, WIRELESS_SCORE, FIBER_SCORE, FIBER_AVAILABLE, FIBER_CUSTOMERS, FIBER_PERCENTAGE, OVERALL_CAT,
                                    FIBER_OPPORTUNITY, NUMBER_OF_PSAS, WIRELESS_CATEGORY, FIBER_AVAILABILITY, ATTR_STORE_COUNT, AR_STORE_COUNT, ALL_STORE_COUNT, SALES_MARKET, ELDERLY_PERCENT
                                    FROM PONDER.SALES_OPP_CMA_PROD WHERE SALES_MARKET1 = '{0}' OR SALES_MARKET2 = '{1}' OR SALES_MARKET3 = '{2}'" },
            {"Get_county_theme_data_region",@"SELECT COPPER_UPGRADE, CNTY_FIPS, TOTALAREA, TOTALPOPS, POP_DENSITY, WIRELESS_SCORE, FIBER_SCORE, FIBER_AVAILABLE, FIBER_CUSTOMERS, FIBER_PERCENTAGE, OVERALL_CAT, STATE_ABBR, COUNTY_STATE,
                                    FIBER_OPPORTUNITY, NUMBER_OF_PSAS, WIRELESS_CATEGORY, FIBER_AVAILABILITY, ATTR_STORE_COUNT, AR_STORE_COUNT, ALL_STORE_COUNT, SALES_MARKET, ELDERLY_PERCENT
                                    FROM PONDER.SALES_OPP_COUNTY_PROD WHERE SALES_REGION = '{0}'" },
            {"Get_county_theme_data_default",@"SELECT COPPER_UPGRADE, CNTY_FIPS, TOTALAREA, TOTALPOPS, POP_DENSITY, WIRELESS_SCORE, FIBER_SCORE, FIBER_AVAILABLE, FIBER_CUSTOMERS, FIBER_PERCENTAGE, OVERALL_CAT, STATE_ABBR, COUNTY_STATE,
                                    FIBER_OPPORTUNITY, NUMBER_OF_PSAS, WIRELESS_CATEGORY, FIBER_AVAILABILITY, ATTR_STORE_COUNT, AR_STORE_COUNT, ALL_STORE_COUNT, SALES_MARKET, ELDERLY_PERCENT
                                    FROM PONDER.SALES_OPP_COUNTY_PROD WHERE SALES_MARKET = '{0}'" },
            {"Get_zip_theme_data",@"SELECT COPPER_UPGRADE, ZIP, TOTALPOPS, POP_DENSITY, WIRELESS_SCORE, FIBER_SCORE, FIBER_AVAILABLE, FIBER_CUSTOMERS, FIBER_PERCENTAGE, OVERALL_CAT, STATE,
                                    FIBER_OPPORTUNITY, NUMBER_OF_PSAS, WIRELESS_CATEGORY, FIBER_AVAILABILITY, ATTR_STORE_COUNT, AR_STORE_COUNT, ALL_STORE_COUNT, ELDERLY_PERCENT
                                    FROM PONDER.SALES_OPP_ZIP_PROD WHERE SALES_MARKET = '{0}'" },
            {"Get_Zip_Store_Detail_Market",@"SELECT STORE_CATEGORY, LOCATION_ID, LOCATION_NAME, MASTER_DEALER, ADDRESS_1, ADDRESS_2, CITY, STATE, ZIP_CODE, COUNTY, LATITUDE, LONGITUDE, REGION AS SALES_REGION, MARKET_GROUP AS SALES_VPGM_MARKET
                                    FROM (SELECT STORE_CATEGORY, LOCATION_ID, LOCATION_NAME, MASTER_DEALER, ADDRESS_1, ADDRESS_2, CITY, STATE, ZIP_CODE, COUNTY, LATITUDE, LONGITUDE, REGION, MARKET_GROUP, ROWNUM ROW_NUM
                                    FROM PONDER.SALES_ATT_STORE_LOC_PROD
                                    WHERE(MARKET_GROUP LIKE '{0}'))
                                    WHERE (ROW_NUM < 3000)" },
            {"Get_CMA_Store_Detail",@"SELECT STORE_CATEGORY, LOCATION_ID, LOCATION_NAME, MASTER_DEALER, ADDRESS_1, ADDRESS_2, CITY, STATE, ZIP_CODE, COUNTY, LATITUDE, LONGITUDE, REGION AS SALES_REGION, MARKET_GROUP AS SALES_VPGM_MARKET
                                    FROM (SELECT STORE_CATEGORY, LOCATION_ID, LOCATION_NAME, MASTER_DEALER, ADDRESS_1, ADDRESS_2, CITY, STATE, ZIP_CODE, COUNTY, LATITUDE, LONGITUDE, REGION, MARKET_GROUP, ROWNUM ROW_NUM
                                    FROM PONDER.SALES_ATT_STORE_LOC_PROD
                                    WHERE (CMA LIKE '{0}') 
                                    OR (LATITUDE <= {1}+1.6 AND LATITUDE >= {2}-1.6
                                    AND LONGITUDE <= {3}+2 AND LONGITUDE >= {4}-2))
                                    WHERE (ROW_NUM < 3000)" },
            {"Get_County_Store_Detail",@"SELECT STORE_CATEGORY, LOCATION_ID, LOCATION_NAME, MASTER_DEALER, ADDRESS_1, ADDRESS_2, CITY, STATE, ZIP_CODE, COUNTY, LATITUDE, LONGITUDE, REGION AS SALES_REGION, MARKET_GROUP AS SALES_VPGM_MARKET
                                    FROM (SELECT STORE_CATEGORY, LOCATION_ID, LOCATION_NAME, MASTER_DEALER, ADDRESS_1, ADDRESS_2, CITY, STATE, ZIP_CODE, COUNTY, LATITUDE, LONGITUDE, REGION, MARKET_GROUP, ROWNUM ROW_NUM
                                    FROM PONDER.SALES_ATT_STORE_LOC_PROD
                                    WHERE (COUNTY_FIP LIKE '{0}') 
                                    OR (LATITUDE <= {1}+1.6 AND LATITUDE >= {2}-1.6
                                    AND LONGITUDE <= {3}+2 AND LONGITUDE >= {4}-2))
                                    WHERE (ROW_NUM < 3000)" },
            {"Get_CMA_PSA_Detail_Market",@"SELECT COPPER_UPGRADE, ZIP_CO_PSA, LATITUDE, LONGITUDE, WIRELESS_SCORE, CMA, SALES_MARKET, CO, PSA,
                                    CASE WHEN WIRELESS_SCORE = 5 THEN 'PSA5'
                                    WHEN WIRELESS_SCORE = 4 THEN 'PSA4'
                                    WHEN WIRELESS_SCORE = 3 THEN 'PSA3'
                                    WHEN WIRELESS_SCORE = 2 THEN 'PSA2'
                                    WHEN WIRELESS_SCORE = 1 THEN 'PSA1'
                                    ELSE 'PSA0' END AS PSA_SCORE,
                                    TO_CHAR(FIBER_AVAILABLE, '999,999,999,999') AS FIBER_AVAILABLE, TO_CHAR(FIBER_CUSTOMERS, '999,999,999,999') AS FIBER_CUSTOMERS, 
                                    TO_CHAR(FIBER_OPPORTUNITY, '999,999,999,999') AS FIBER_OPPORTUNITY, FIBER_PENETRATION,
                                    CASE WHEN WIRELESS_SCORE = 5 THEN '5 (Best)'
                                    WHEN WIRELESS_SCORE = 4 THEN '4 (Very Strong)'
                                    WHEN WIRELESS_SCORE = 3 THEN '3 (Strong)'
                                    WHEN WIRELESS_SCORE = 2 THEN '2 (Uneven)'
                                    WHEN WIRELESS_SCORE = 1 THEN '1 (Very Weak)'
                                    ELSE 'Not enough Samples' END AS WIRELESS_SCORE_TEXT
                                    FROM (SELECT COPPER_UPGRADE, ZIP_CO_PSA, LATITUDE, LONGITUDE, WIRELESS_SCORE, CMA, SALES_MARKET, CO, PSA, FIBER_AVAILABLE, FIBER_CUSTOMERS, FIBER_OPPORTUNITY, CONCAT(ROUND(100 * FIBER_CUSTOMERS / FIBER_AVAILABLE,1), '%') AS FIBER_PENETRATION
                                    FROM PONDER.SALES_OPP_PSA_PROD
                                    WHERE CMA LIKE '{0}'
                                    AND FIBER_OPPORTUNITY > 10
                                    ORDER BY CMA_RANK)
                                    WHERE (ROWNUM <= 25)" },
            {"Get_County_PSA_Detail_Market",@"SELECT COPPER_UPGRADE, ZIP_CO_PSA, LATITUDE, LONGITUDE, WIRELESS_SCORE, COUNTY_FIPS, SALES_MARKET, CO, PSA,
                                    CASE WHEN WIRELESS_SCORE = 5 THEN 'PSA5'
                                    WHEN WIRELESS_SCORE = 4 THEN 'PSA4'
                                    WHEN WIRELESS_SCORE = 3 THEN 'PSA3'
                                    WHEN WIRELESS_SCORE = 2 THEN 'PSA2'
                                    WHEN WIRELESS_SCORE = 1 THEN 'PSA1'
                                    ELSE 'PSA0' END AS PSA_SCORE,
                                    TO_CHAR(FIBER_AVAILABLE, '999,999,999,999') AS FIBER_AVAILABLE, TO_CHAR(FIBER_CUSTOMERS, '999,999,999,999') AS FIBER_CUSTOMERS, 
                                    TO_CHAR(FIBER_OPPORTUNITY, '999,999,999,999') AS FIBER_OPPORTUNITY, FIBER_PENETRATION,
                                    CASE WHEN WIRELESS_SCORE = 5 THEN '5 (Best)'
                                    WHEN WIRELESS_SCORE = 4 THEN '4 (Very Strong)'
                                    WHEN WIRELESS_SCORE = 3 THEN '3 (Strong)'
                                    WHEN WIRELESS_SCORE = 2 THEN '2 (Uneven)'
                                    WHEN WIRELESS_SCORE = 1 THEN '1 (Very Weak)'
                                    ELSE 'Not enough Samples' END AS WIRELESS_SCORE_TEXT
                                    FROM (SELECT COPPER_UPGRADE, ZIP_CO_PSA, LATITUDE, LONGITUDE, WIRELESS_SCORE, COUNTY_FIPS, SALES_MARKET, CO, PSA, FIBER_AVAILABLE, FIBER_CUSTOMERS, FIBER_OPPORTUNITY, CONCAT(ROUND(100 * FIBER_CUSTOMERS / FIBER_AVAILABLE,1), '%') AS FIBER_PENETRATION
                                    FROM PONDER.SALES_OPP_PSA_PROD
                                    WHERE COUNTY_FIPS LIKE '{0}'
                                    AND FIBER_OPPORTUNITY > 10
                                    ORDER BY COUNTY_RANK)
                                    WHERE (ROWNUM <= 25)" },
            {"Get_Zip_PSA_Detail_Market",@"SELECT COPPER_UPGRADE, ZIP_CO_PSA, LATITUDE, LONGITUDE, WIRELESS_SCORE, ZIP, SALES_MARKET, CO, PSA,
                                    CASE WHEN WIRELESS_SCORE = 5 THEN 'PSA5'
                                    WHEN WIRELESS_SCORE = 4 THEN 'PSA4'
                                    WHEN WIRELESS_SCORE = 3 THEN 'PSA3'
                                    WHEN WIRELESS_SCORE = 2 THEN 'PSA2'
                                    WHEN WIRELESS_SCORE = 1 THEN 'PSA1'
                                    ELSE 'PSA0' END AS PSA_SCORE,
                                    TO_CHAR(FIBER_AVAILABLE, '999,999,999,999') AS FIBER_AVAILABLE, TO_CHAR(FIBER_CUSTOMERS, '999,999,999,999') AS FIBER_CUSTOMERS, 
                                    TO_CHAR(FIBER_OPPORTUNITY, '999,999,999,999') AS FIBER_OPPORTUNITY, FIBER_PENETRATION,
                                    CASE WHEN DISTINCT_MAPPABLE / (FIBER_AVAILABLE - MISSING_LAT_LONG) >= .8 THEN 'Low - Few or No MDUs'
                                    WHEN DISTINCT_MAPPABLE / (FIBER_AVAILABLE - MISSING_LAT_LONG) <= .2 THEN 'High - Significant MDUs'
                                    ELSE 'Med - Some MDUs' END AS MDU_DENSITY_TEXT,
                                    CASE WHEN WIRELESS_SCORE = 5 THEN '5 (Best)'
                                    WHEN WIRELESS_SCORE = 4 THEN '4 (Very Strong)'
                                    WHEN WIRELESS_SCORE = 3 THEN '3 (Strong)'
                                    WHEN WIRELESS_SCORE = 2 THEN '2 (Uneven)'
                                    WHEN WIRELESS_SCORE = 1 THEN '1 (Very Weak)'
                                    ELSE 'Not enough Samples' END AS WIRELESS_SCORE_TEXT
                                    FROM (SELECT COPPER_UPGRADE, ZIP_CO_PSA, LATITUDE, LONGITUDE, WIRELESS_SCORE, ZIP, SALES_MARKET, CO, PSA, ROWNUM ROW_NUM, FIBER_AVAILABLE, FIBER_CUSTOMERS, FIBER_OPPORTUNITY, 
                                    CONCAT(ROUND(100 * FIBER_CUSTOMERS / FIBER_AVAILABLE,1), '%') AS FIBER_PENETRATION, MISSING_LAT_LONG, DISTINCT_MAPPABLE
                                    FROM PONDER.SALES_OPP_PSA_PROD
                                    WHERE ZIP LIKE '{0}')
                                    WHERE (ROW_NUM < 3000)" },
            {"Get_ZIP_MDU",@"SELECT TDATE.DATA_DATE, T1.* FROM (SELECT HOUSE_NUMBER, PREFIX, STREET_NAME, ZIP, CITY, STATE, WIRELESS_SCORE, FIBER_AVAILABLE, FIBER_OPPORTUNITY, CONCAT(TO_CHAR(FIBER_PENETRATION_RATE,'FM99990.0'),'%') AS FIBER_PENETRATION_RATE, LATITUDE, LONGITUDE,
                                    CASE WHEN WIRELESS_SCORE = 5 THEN '5 (Best)'
                                    WHEN WIRELESS_SCORE = 4 THEN '4 (Very Strong)'
                                    WHEN WIRELESS_SCORE = 3 THEN '3 (Strong)'
                                    WHEN WIRELESS_SCORE = 2 THEN '2 (Uneven)'
                                    WHEN WIRELESS_SCORE = 1 THEN '1 (Very Weak)'
                                    ELSE 'Not enough Samples' END AS WIRELESS_SCORE_TEXT,
                                    ZIP_RANK, MARKET_RANK
                                    FROM PONDER.SALES_OPP_MDU_PROD
                                    WHERE ZIP LIKE '{0}'
                                    AND ZIP_RANK <= 50
                                    ORDER BY ZIP_RANK, FIBER_OPPORTUNITY DESC) T1
                                    LEFT JOIN (SELECT DATA_DATE FROM PONDER.SALES_OPP_DATA_INFO_TEST WHERE DATA_SOURCE = 'OVALS_Active_Fiber')TDATE ON 1=1
                                    WHERE ROWNUM <= 50" },
            {"Get_CMA_MDU",@"SELECT TDATE.DATA_DATE, T1.* FROM (SELECT HOUSE_NUMBER, PREFIX, STREET_NAME, ZIP, CITY, STATE, WIRELESS_SCORE, FIBER_AVAILABLE, FIBER_OPPORTUNITY, CONCAT(TO_CHAR(FIBER_PENETRATION_RATE,'FM99990.0'),'%') AS FIBER_PENETRATION_RATE, LATITUDE, LONGITUDE,
                                    CASE WHEN WIRELESS_SCORE = 5 THEN '5 (Best)'
                                    WHEN WIRELESS_SCORE = 4 THEN '4 (Very Strong)'
                                    WHEN WIRELESS_SCORE = 3 THEN '3 (Strong)'
                                    WHEN WIRELESS_SCORE = 2 THEN '2 (Uneven)'
                                    WHEN WIRELESS_SCORE = 1 THEN '1 (Very Weak)'
                                    ELSE 'Not enough Samples' END AS WIRELESS_SCORE_TEXT,
                                    CMA_RANK, MARKET_RANK
                                    FROM PONDER.SALES_OPP_MDU_PROD
                                    WHERE CMA LIKE '{0}'
                                    AND CMA_RANK <= 50
                                    ORDER BY CMA_RANK, FIBER_OPPORTUNITY DESC) T1
                                    LEFT JOIN (SELECT DATA_DATE FROM PONDER.SALES_OPP_DATA_INFO_TEST WHERE DATA_SOURCE = 'OVALS_Active_Fiber')TDATE ON 1=1
                                    WHERE ROWNUM <= 50" },
            {"Get_County_MDU",@"SELECT TDATE.DATA_DATE, T1.* FROM (SELECT HOUSE_NUMBER, PREFIX, STREET_NAME, ZIP, CITY, STATE,   
                                    CASE WHEN WIRELESS_SCORE = 5 THEN '5 (Best)'
                                    WHEN WIRELESS_SCORE = 4 THEN '4 (Very Strong)'
                                    WHEN WIRELESS_SCORE = 3 THEN '3 (Strong)'
                                    WHEN WIRELESS_SCORE = 2 THEN '2 (Uneven)'
                                    WHEN WIRELESS_SCORE = 1 THEN '1 (Very Weak)'
                                    ELSE 'Not enough Samples' END AS WIRELESS_SCORE_TEXT,
                                    FIBER_AVAILABLE, FIBER_OPPORTUNITY, CONCAT(TO_CHAR(FIBER_PENETRATION_RATE,'FM99990.0'),'%') AS FIBER_PENETRATION_RATE, MARKET_RANK, COUNTY_RANK, LATITUDE, LONGITUDE, WIRELESS_SCORE
                                    FROM PONDER.SALES_OPP_MDU_PROD
                                    WHERE COUNTY_FIPS LIKE '{0}' AND COUNTY_RANK <= 50
                                    ORDER BY COUNTY_RANK) T1
                                    LEFT JOIN (SELECT DATA_DATE FROM PONDER.SALES_OPP_DATA_INFO_TEST WHERE DATA_SOURCE = 'OVALS_Active_Fiber')TDATE ON 1=1
                                    WHERE ROWNUM <= 50" },
            {"showData_PSAAddressesCMA",@"SELECT TBL1.*, TBL2.WIRELESS_SCORE FROM (SELECT ZIP_CO_PSA, HOUSE_NUMBER, PREFIX, STREET_NAME, UNIT_NUMBER, CITY, ZIP, STATE, CASE WHEN DL_MAX_SPEED > 1 THEN 'Yes' ELSE 'No' END AS HYPERGIG, CASE WHEN REGREEN = 1 THEN 'Yes' ELSE 'No' END AS REGREEN, CASE WHEN ADSL = 1 THEN 'Yes' ELSE 'No' END AS ADSL, CASE WHEN CSI_ELIGIBLE = 1 THEN 'Yes' ELSE 'No' END AS CSI_ELIGIBLE,
                                    CASE WHEN SERVICE_STATUS = 'InService' THEN 'Customer' WHEN SERVICE_STATUS IS NULL AND BB_ALL = 1 AND BB_FIBR = 0 THEN  'Upgrade' ELSE 'Prospect' END AS SERVICE_STATUS, 
                                    DWELLING_TYPE FROM PONDER.SALES_OPP_FIBER_ADDR)TBL1
                                    INNER JOIN (SELECT ZIP_CO_PSA, WIRELESS_SCORE
                                    FROM (SELECT ZIP_CO_PSA, LATITUDE, LONGITUDE, WIRELESS_SCORE, WIRELESS_CATEGORY, ZIP, CMA, SALES_MARKET, CO, PSA, FIBER_AVAILABLE, FIBER_CUSTOMERS, FIBER_OPPORTUNITY
                                    FROM PONDER.SALES_OPP_PSA_PROD
                                    WHERE CMA = '{0}'
                                    AND FIBER_OPPORTUNITY > 10
                                    ORDER BY CMA_RANK)
                                    WHERE (ROWNUM <= 25))TBL2
                                    ON tbl1.zip_co_psa = tbl2.zip_co_psa
                                    WHERE ROWNUM < 3001
                                    ORDER BY TBL1.ZIP_CO_PSA, STREET_NAME, HOUSE_NUMBER, UNIT_NUMBER" },
            {"showData_PSAAddressesCounty",@"SELECT TBL1.*, TBL2.WIRELESS_SCORE FROM (SELECT ZIP_CO_PSA, HOUSE_NUMBER, PREFIX, STREET_NAME, UNIT_NUMBER, CITY, ZIP, STATE, CASE WHEN DL_MAX_SPEED > 1 THEN 'Yes' ELSE 'No' END AS HYPERGIG, CASE WHEN REGREEN = 1 THEN 'Yes' ELSE 'No' END AS REGREEN, CASE WHEN ADSL = 1 THEN 'Yes' ELSE 'No' END AS ADSL, CASE WHEN CSI_ELIGIBLE = 1 THEN 'Yes' ELSE 'No' END AS CSI_ELIGIBLE,
                                    CASE WHEN SERVICE_STATUS = 'InService' THEN 'Customer' WHEN SERVICE_STATUS IS NULL AND BB_ALL = 1 AND BB_FIBR = 0 THEN  'Upgrade' ELSE 'Prospect' END AS SERVICE_STATUS, 
                                    DWELLING_TYPE FROM PONDER.SALES_OPP_FIBER_ADDR)TBL1
                                    INNER JOIN (SELECT ZIP_CO_PSA, WIRELESS_SCORE
                                    FROM (SELECT ZIP_CO_PSA, LATITUDE, LONGITUDE, WIRELESS_SCORE, WIRELESS_CATEGORY, ZIP, CMA, SALES_MARKET, CO, PSA, FIBER_AVAILABLE, FIBER_CUSTOMERS, FIBER_OPPORTUNITY
                                    FROM PONDER.SALES_OPP_PSA_PROD
                                    WHERE COUNTY_FIPS = '{0}'
                                    AND FIBER_OPPORTUNITY > 10
                                    ORDER BY COUNTY_RANK)
                                    WHERE (ROWNUM <= 25))TBL2
                                    ON tbl1.zip_co_psa = tbl2.zip_co_psa
                                    WHERE ROWNUM < 3001
                                    ORDER BY TBL1.ZIP_CO_PSA, STREET_NAME, HOUSE_NUMBER, UNIT_NUMBER" },
            {"showData_PSAAddresses",@"SELECT TBL1.*, TBL2.WIRELESS_SCORE FROM (SELECT ZIP_CO_PSA, HOUSE_NUMBER, PREFIX, STREET_NAME, UNIT_NUMBER, CITY, ZIP, STATE, CASE WHEN DL_MAX_SPEED > 1 THEN 'Yes' ELSE 'No' END AS HYPERGIG, CASE WHEN REGREEN = 1 THEN 'Yes' ELSE 'No' END AS REGREEN, CASE WHEN ADSL = 1 THEN 'Yes' ELSE 'No' END AS ADSL, CASE WHEN CSI_ELIGIBLE = 1 THEN 'Yes' ELSE 'No' END AS CSI_ELIGIBLE,
                                    CASE WHEN SERVICE_STATUS = 'InService' THEN 'Customer' WHEN SERVICE_STATUS IS NULL AND BB_ALL = 1 AND BB_FIBR = 0 THEN  'Upgrade' ELSE 'Prospect' END AS SERVICE_STATUS, 
                                    DWELLING_TYPE FROM PONDER.SALES_OPP_FIBER_ADDR)TBL1
                                    INNER JOIN (SELECT ZIP_CO_PSA, WIRELESS_SCORE
                                    FROM (SELECT ZIP_CO_PSA, LATITUDE, LONGITUDE, WIRELESS_SCORE, WIRELESS_CATEGORY, ZIP, CMA, SALES_MARKET, CO, PSA, FIBER_AVAILABLE, FIBER_CUSTOMERS, FIBER_OPPORTUNITY
                                    FROM PONDER.SALES_OPP_PSA_PROD
                                    WHERE ZIP = '{0}'
                                    AND FIBER_OPPORTUNITY > 10
                                    ORDER BY ZIP_RANK)
                                    WHERE (ROWNUM <= 25))TBL2
                                    ON tbl1.zip_co_psa = tbl2.zip_co_psa
                                    WHERE ROWNUM < 3001
                                    ORDER BY TBL1.ZIP_CO_PSA, STREET_NAME, HOUSE_NUMBER, UNIT_NUMBER" },
            {"showData_PSAAddressesCMAFromMap", @"SELECT TBL1.ZIP_CO_PSA, TBL1.HOUSE_NUMBER, TBL1.PREFIX, TBL1.STREET_NAME, TBL1.UNIT_NUMBER, TBL1.CITY, TBL1.ZIP, TBL1.STATE, TBL1.HYPERGIG, TBL1.REGREEN, TBL1.ADSL, TBL1.CSI_ELIGIBLE, TBL1.SERVICE_STATUS, TBL1.DWELLING_TYPE, TBL2.WIRELESS_SCORE FROM (
                                    SELECT ZIP_CO_PSA, HOUSE_NUMBER, PREFIX, STREET_NAME, UNIT_NUMBER, CITY, ZIP, STATE, CASE WHEN DL_MAX_SPEED > 1 THEN 'Yes' ELSE 'No' END AS HYPERGIG, CASE WHEN REGREEN = 1 THEN 'Yes' ELSE 'No' END AS REGREEN, CASE WHEN ADSL = 1 THEN 'Yes' ELSE 'No' END AS ADSL, CASE WHEN CSI_ELIGIBLE = 1 THEN 'Yes' ELSE 'No' END AS CSI_ELIGIBLE,
                                    CASE WHEN SERVICE_STATUS = 'InService' THEN 'Customer' WHEN SERVICE_STATUS IS NULL AND BB_ALL = 1 AND BB_FIBR = 0 THEN  'Upgrade' ELSE 'Prospect' END AS SERVICE_STATUS,  
                                    DWELLING_TYPE
                                    FROM PONDER.SALES_OPP_FIBER_ADDR 
                                    WHERE ZIP_CO_PSA = '{0}')TBL1
                                    LEFT JOIN
                                    (SELECT ZIP_CO_PSA, WIRELESS_SCORE
                                    FROM PONDER.SALES_OPP_PSA_PROD
                                    WHERE ZIP_CO_PSA = '{1}')TBL2
                                    ON TBL1.ZIP_CO_PSA = TBL2.ZIP_CO_PSA
                                    ORDER BY TBL1.ZIP_CO_PSA, TBL1.STREET_NAME, TBL1.HOUSE_NUMBER, TBL1.UNIT_NUMBER" },
            {"showData_PSAAddressesCountyFromMap",@"SELECT TBL1.ZIP_CO_PSA, TBL1.HOUSE_NUMBER, TBL1.PREFIX, TBL1.STREET_NAME, TBL1.UNIT_NUMBER, TBL1.CITY, TBL1.ZIP, TBL1.STATE, TBL1.HYPERGIG, TBL1.SERVICE_STATUS, TBL1.DWELLING_TYPE, TBL2.WIRELESS_SCORE FROM (
                                    SELECT ZIP_CO_PSA, HOUSE_NUMBER, PREFIX, STREET_NAME, UNIT_NUMBER, CITY, ZIP, STATE, CASE WHEN DL_MAX_SPEED > 1 THEN 'Yes' ELSE 'No' END AS HYPERGIG, 
                                    CASE WHEN SERVICE_STATUS = 'InService' THEN 'Customer' WHEN SERVICE_STATUS IS NULL AND BB_ALL = 1 AND BB_FIBR = 0 THEN  'Upgrade' ELSE 'Prospect' END AS SERVICE_STATUS, 
                                    DWELLING_TYPE
                                    FROM PONDER.SALES_OPP_FIBER_ADDR 
                                    WHERE ZIP_CO_PSA = '{0}')TBL1
                                    LEFT JOIN
                                    (SELECT ZIP_CO_PSA, WIRELESS_SCORE
                                    FROM PONDER.SALES_OPP_PSA_PROD
                                    WHERE ZIP_CO_PSA = '{1}')TBL2
                                    ON TBL1.ZIP_CO_PSA = TBL2.ZIP_CO_PSA
                                    ORDER BY TBL1.ZIP_CO_PSA, TBL1.STREET_NAME, TBL1.HOUSE_NUMBER, TBL1.UNIT_NUMBER" },
            {"showData_PSAAddressesZipFromMap",@"SELECT TBL1.ZIP_CO_PSA, TBL1.HOUSE_NUMBER, TBL1.PREFIX, TBL1.STREET_NAME, TBL1.UNIT_NUMBER, TBL1.CITY, TBL1.ZIP, TBL1.STATE, TBL1.HYPERGIG, TBL1.REGREEN, TBL1.ADSL, TBL1.CSI_ELIGIBLE, TBL1.SERVICE_STATUS, TBL1.DWELLING_TYPE, TBL2.WIRELESS_SCORE FROM (
                                    SELECT ZIP_CO_PSA, HOUSE_NUMBER, PREFIX, STREET_NAME, UNIT_NUMBER, CITY, ZIP, STATE, CASE WHEN DL_MAX_SPEED > 1 THEN 'Yes' ELSE 'No' END AS HYPERGIG, CASE WHEN REGREEN = 1 THEN 'Yes' ELSE 'No' END AS REGREEN, CASE WHEN ADSL = 1 THEN 'Yes' ELSE 'No' END AS ADSL, CASE WHEN CSI_ELIGIBLE = 1 THEN 'Yes' ELSE 'No' END AS CSI_ELIGIBLE,
                                    CASE WHEN SERVICE_STATUS = 'InService' THEN 'Customer' WHEN SERVICE_STATUS IS NULL AND BB_ALL = 1 AND BB_FIBR = 0 THEN  'Upgrade' ELSE 'Prospect' END AS SERVICE_STATUS,  
                                    DWELLING_TYPE
                                    FROM PONDER.SALES_OPP_FIBER_ADDR 
                                    WHERE ZIP_CO_PSA = '{0}')TBL1
                                    LEFT JOIN
                                    (SELECT ZIP_CO_PSA, WIRELESS_SCORE
                                    FROM PONDER.SALES_OPP_PSA_PROD
                                    WHERE ZIP_CO_PSA = '{1}')TBL2
                                    ON TBL1.ZIP_CO_PSA = TBL2.ZIP_CO_PSA
                                    ORDER BY TBL1.ZIP_CO_PSA, TBL1.STREET_NAME, TBL1.HOUSE_NUMBER, TBL1.UNIT_NUMBER" },
            {"showData_MDUAddressesCMA",@"SELECT T1.SALES_MARKET AS VPGM_MARKET, T1.CMA, T1.CMA_NAME, T1.ZIP_CO_PSA, T1.WIRELESS_SCORE,
                                    CASE WHEN T1.WIRELESS_SCORE = 5 THEN 'Best'
                                    WHEN T1.WIRELESS_SCORE = 4 THEN 'Very Strong'
                                    WHEN T1.WIRELESS_SCORE = 3 THEN 'Strong'
                                    WHEN T1.WIRELESS_SCORE = 2 THEN 'Uneven'
                                    WHEN T1.WIRELESS_SCORE = 1 THEN 'Very Weak'
                                    ELSE 'Not enough Samples' END AS WIRELESS_SCORE_TEXT,
                                    T2.HOUSE_NUMBER, T2.PREFIX, T2.STREET_NAME, T2.BUILDING_NUMBER, T2.UNIT_NUMBER, 
                                    T2.CITY, T2.ZIP, T2.STATE, CASE WHEN T2.DL_MAX_SPEED > 1 THEN 'Yes' ELSE 'No' END AS HYPERGIG, CASE WHEN REGREEN = 1 THEN 'Yes' ELSE 'No' END AS REGREEN, CASE WHEN ADSL = 1 THEN 'Yes' ELSE 'No' END AS ADSL, CASE WHEN CSI_ELIGIBLE = 1 THEN 'Yes' ELSE 'No' END AS CSI_ELIGIBLE,
                                    CASE WHEN T2.SERVICE_STATUS = 'InService' THEN 'Customer' WHEN T2.SERVICE_STATUS IS NULL AND T2.BB_ALL = 1 AND T2.BB_FIBR = 0 THEN  'Upgrade' ELSE 'Prospect' END AS SERVICE_STATUS, 
                                    T2.DWELLING_TYPE, T2.LATITUDE, T2.LONGITUDE, T1.CMA_RANK, T1.MARKET_RANK
                                    FROM PONDER.SALES_OPP_MDU_PROD T1
                                    LEFT JOIN PONDER.SALES_OPP_FIBER_ADDR T2
                                    ON T1.ZIP = T2.ZIP AND T1.HOUSE_NUMBER = T2.HOUSE_NUMBER AND T1.PREFIX = T2.PREFIX AND T1.STREET_NAME = T2.STREET_NAME 
                                    WHERE T1.CMA = '{0}' AND T1.CMA_RANK <= 50
                                    ORDER BY T1.CMA_RANK, T1.ZIP, T1.STREET_NAME, T1.PREFIX, T2.BUILDING_NUMBER, T2.UNIT_NUMBER" },
            {"showData_MDUAddressesCMAFromMap",@"SELECT T1.SALES_MARKET AS VPGM_MARKET, T1.CMA, T1.CMA_NAME, T1.ZIP_CO_PSA, T1.WIRELESS_SCORE,
                                    CASE WHEN T1.WIRELESS_SCORE = 5 THEN 'Best'
                                    WHEN T1.WIRELESS_SCORE = 4 THEN 'Very Strong'
                                    WHEN T1.WIRELESS_SCORE = 3 THEN 'Strong'
                                    WHEN T1.WIRELESS_SCORE = 2 THEN 'Uneven'
                                    WHEN T1.WIRELESS_SCORE = 1 THEN 'Very Weak'
                                    ELSE 'Not enough Samples' END AS WIRELESS_SCORE_TEXT,
                                    T2.HOUSE_NUMBER, T2.PREFIX, T2.STREET_NAME, T2.BUILDING_NUMBER, T2.UNIT_NUMBER, 
                                    T2.CITY, T2.ZIP, T2.STATE, CASE WHEN T2.DL_MAX_SPEED > 1 THEN 'Yes' ELSE 'No' END AS HYPERGIG, CASE WHEN REGREEN = 1 THEN 'Yes' ELSE 'No' END AS REGREEN, CASE WHEN ADSL = 1 THEN 'Yes' ELSE 'No' END AS ADSL, CASE WHEN CSI_ELIGIBLE = 1 THEN 'Yes' ELSE 'No' END AS CSI_ELIGIBLE,
                                    CASE WHEN T2.SERVICE_STATUS = 'InService' THEN 'Customer' WHEN T2.SERVICE_STATUS IS NULL AND T2.BB_ALL = 1 AND T2.BB_FIBR = 0 THEN  'Upgrade' ELSE 'Prospect' END AS SERVICE_STATUS, 
                                    T2.DWELLING_TYPE, T2.LATITUDE, T2.LONGITUDE, T1.CMA_RANK, T1.MARKET_RANK
                                    FROM PONDER.SALES_OPP_MDU_PROD T1
                                    LEFT JOIN PONDER.SALES_OPP_FIBER_ADDR T2
                                    ON T1.ZIP = T2.ZIP AND T1.HOUSE_NUMBER = T2.HOUSE_NUMBER AND T1.PREFIX = T2.PREFIX AND T1.STREET_NAME = T2.STREET_NAME 
                                    WHERE T1.HOUSE_NUMBER = '{1}' AND T1.PREFIX = '{2}' AND T1.STREET_NAME = '{3}' AND T1.ZIP = '{4}'
                                    ORDER BY T1.ZIP, T1.STREET_NAME, T1.PREFIX, T2.BUILDING_NUMBER, T2.UNIT_NUMBER" },
            {"showData_MDUAddressesCMAFromTable",@"SELECT T1.SALES_MARKET AS VPGM_MARKET, T1.CMA, T1.CMA_NAME, T1.ZIP_CO_PSA, T1.WIRELESS_SCORE,
                                    CASE WHEN T1.WIRELESS_SCORE = 5 THEN 'Best'
                                    WHEN T1.WIRELESS_SCORE = 4 THEN 'Very Strong'
                                    WHEN T1.WIRELESS_SCORE = 3 THEN 'Strong'
                                    WHEN T1.WIRELESS_SCORE = 2 THEN 'Uneven'
                                    WHEN T1.WIRELESS_SCORE = 1 THEN 'Very Weak'
                                    ELSE 'Not enough Samples' END AS WIRELESS_SCORE_TEXT,
                                    T2.HOUSE_NUMBER, T2.PREFIX, T2.STREET_NAME, T2.BUILDING_NUMBER, T2.UNIT_NUMBER, 
                                    T2.CITY, T2.ZIP, T2.STATE, CASE WHEN T2.DL_MAX_SPEED > 1 THEN 'Yes' ELSE 'No' END AS HYPERGIG, CASE WHEN REGREEN = 1 THEN 'Yes' ELSE 'No' END AS REGREEN, CASE WHEN ADSL = 1 THEN 'Yes' ELSE 'No' END AS ADSL, CASE WHEN CSI_ELIGIBLE = 1 THEN 'Yes' ELSE 'No' END AS CSI_ELIGIBLE,
                                    CASE WHEN T2.SERVICE_STATUS = 'InService' THEN 'Customer' WHEN T2.SERVICE_STATUS IS NULL AND T2.BB_ALL = 1 AND T2.BB_FIBR = 0 THEN  'Upgrade' ELSE 'Prospect' END AS SERVICE_STATUS, 
                                    T2.DWELLING_TYPE, T2.LATITUDE, T2.LONGITUDE, T1.CMA_RANK, T1.MARKET_RANK
                                    FROM PONDER.SALES_OPP_MDU_PROD T1
                                    LEFT JOIN PONDER.SALES_OPP_FIBER_ADDR T2
                                    ON T1.ZIP = T2.ZIP AND T1.HOUSE_NUMBER = T2.HOUSE_NUMBER AND T1.PREFIX = T2.PREFIX AND T1.STREET_NAME = T2.STREET_NAME 
                                    WHERE T1.HOUSE_NUMBER = '{1}' AND T1.PREFIX = '{2}' AND T1.STREET_NAME = '{3}' AND T1.ZIP = '{4}'
                                    ORDER BY T1.ZIP, T1.STREET_NAME, T1.PREFIX, T2.BUILDING_NUMBER, T2.UNIT_NUMBER" },
            {"showData_MDUAddressesCounty",@"SELECT T1.SALES_MARKET AS VPGM_MARKET, T1.COUNTY_FIPS, T1.ZIP_CO_PSA, T1.WIRELESS_SCORE,
                                    CASE WHEN T1.WIRELESS_SCORE = 5 THEN 'Best'
                                    WHEN T1.WIRELESS_SCORE = 4 THEN 'Very Strong'
                                    WHEN T1.WIRELESS_SCORE = 3 THEN 'Strong'
                                    WHEN T1.WIRELESS_SCORE = 2 THEN 'Uneven'
                                    WHEN T1.WIRELESS_SCORE = 1 THEN 'Very Weak'
                                    ELSE 'Not enough Samples' END AS WIRELESS_SCORE_TEXT,
                                    T2.HOUSE_NUMBER, T2.PREFIX, T2.STREET_NAME, T2.BUILDING_NUMBER, T2.UNIT_NUMBER, 
                                    T2.CITY, T2.ZIP, T2.STATE, CASE WHEN T2.DL_MAX_SPEED > 1 THEN 'Yes' ELSE 'No' END AS HYPERGIG, CASE WHEN REGREEN = 1 THEN 'Yes' ELSE 'No' END AS REGREEN, CASE WHEN ADSL = 1 THEN 'Yes' ELSE 'No' END AS ADSL, CASE WHEN CSI_ELIGIBLE = 1 THEN 'Yes' ELSE 'No' END AS CSI_ELIGIBLE,
                                    CASE WHEN T2.SERVICE_STATUS = 'InService' THEN 'Customer' WHEN T2.SERVICE_STATUS IS NULL AND T2.BB_ALL = 1 AND T2.BB_FIBR = 0 THEN  'Upgrade' ELSE 'Prospect' END AS SERVICE_STATUS,  
                                    T2.DWELLING_TYPE, T2.LATITUDE, T2.LONGITUDE, T1.COUNTY_RANK, T1.MARKET_RANK
                                    FROM PONDER.SALES_OPP_MDU_PROD T1
                                    LEFT JOIN PONDER.SALES_OPP_FIBER_ADDR T2
                                    ON T1.ZIP = T2.ZIP AND T1.HOUSE_NUMBER = T2.HOUSE_NUMBER AND T1.PREFIX = T2.PREFIX AND T1.STREET_NAME = T2.STREET_NAME 
                                    WHERE T1.COUNTY_FIPS = '{0}' AND T1.COUNTY_RANK <= 50
                                    ORDER BY T1.COUNTY_RANK, T1.ZIP, T1.STREET_NAME, T1.PREFIX, T2.BUILDING_NUMBER, T2.UNIT_NUMBER" },
            {"showData_MDUAddressesZip",@"SELECT T1.SALES_MARKET AS VPGM_MARKET, T1.ZIP_CO_PSA, T1.WIRELESS_SCORE,
                                    CASE WHEN T1.WIRELESS_SCORE = 5 THEN 'Best'
                                    WHEN T1.WIRELESS_SCORE = 4 THEN 'Very Strong'
                                    WHEN T1.WIRELESS_SCORE = 3 THEN 'Strong'
                                    WHEN T1.WIRELESS_SCORE = 2 THEN 'Uneven'
                                    WHEN T1.WIRELESS_SCORE = 1 THEN 'Very Weak'
                                    ELSE 'Not enough Samples' END AS WIRELESS_SCORE_TEXT,
                                    T2.HOUSE_NUMBER, T2.PREFIX, T2.STREET_NAME, T2.BUILDING_NUMBER, T2.UNIT_NUMBER, 
                                    T2.CITY, T2.ZIP, T2.STATE, CASE WHEN T2.DL_MAX_SPEED > 1 THEN 'Yes' ELSE 'No' END AS HYPERGIG, CASE WHEN REGREEN = 1 THEN 'Yes' ELSE 'No' END AS REGREEN, CASE WHEN ADSL = 1 THEN 'Yes' ELSE 'No' END AS ADSL, CASE WHEN CSI_ELIGIBLE = 1 THEN 'Yes' ELSE 'No' END AS CSI_ELIGIBLE,
                                    CASE WHEN T2.SERVICE_STATUS = 'InService' THEN 'Customer' WHEN T2.SERVICE_STATUS IS NULL AND T2.BB_ALL = 1 AND T2.BB_FIBR = 0 THEN  'Upgrade' ELSE 'Prospect' END AS SERVICE_STATUS,
                                    T2.DWELLING_TYPE, T2.LATITUDE, T2.LONGITUDE, T1.ZIP_RANK, T1.MARKET_RANK
                                    FROM PONDER.SALES_OPP_MDU_PROD T1
                                    LEFT JOIN PONDER.SALES_OPP_FIBER_ADDR T2
                                    ON T1.ZIP = T2.ZIP AND T1.HOUSE_NUMBER = T2.HOUSE_NUMBER AND T1.PREFIX = T2.PREFIX AND T1.STREET_NAME = T2.STREET_NAME 
                                    WHERE T1.ZIP = '{0}' AND T1.ZIP_RANK <= 50
                                    ORDER BY T1.ZIP_RANK, T1.ZIP, T1.STREET_NAME, T1.PREFIX, T2.BUILDING_NUMBER, T2.UNIT_NUMBER" },
            {"showData_MDUAddressesCountyFromMap",@"SELECT T1.SALES_MARKET AS VPGM_MARKET, T1.COUNTY_FIPS, T1.ZIP_CO_PSA, T1.WIRELESS_SCORE,
                                    CASE WHEN T1.WIRELESS_SCORE = 5 THEN 'Best'
                                    WHEN T1.WIRELESS_SCORE = 4 THEN 'Very Strong'
                                    WHEN T1.WIRELESS_SCORE = 3 THEN 'Strong'
                                    WHEN T1.WIRELESS_SCORE = 2 THEN 'Uneven'
                                    WHEN T1.WIRELESS_SCORE = 1 THEN 'Very Weak'
                                    ELSE 'Not enough Samples' END AS WIRELESS_SCORE_TEXT,
                                    T2.HOUSE_NUMBER, T2.PREFIX, T2.STREET_NAME, T2.BUILDING_NUMBER, T2.UNIT_NUMBER, 
                                    T2.CITY, T2.ZIP, T2.STATE, CASE WHEN T2.DL_MAX_SPEED > 1 THEN 'Yes' ELSE 'No' END AS HYPERGIG, CASE WHEN REGREEN = 1 THEN 'Yes' ELSE 'No' END AS REGREEN, CASE WHEN ADSL = 1 THEN 'Yes' ELSE 'No' END AS ADSL, CASE WHEN CSI_ELIGIBLE = 1 THEN 'Yes' ELSE 'No' END AS CSI_ELIGIBLE,
                                    CASE WHEN T2.SERVICE_STATUS = 'InService' THEN 'Customer' WHEN T2.SERVICE_STATUS IS NULL AND T2.BB_ALL = 1 AND T2.BB_FIBR = 0 THEN  'Upgrade' ELSE 'Prospect' END AS SERVICE_STATUS,  
                                    T2.DWELLING_TYPE, T2.LATITUDE, T2.LONGITUDE, T1.COUNTY_RANK, T1.MARKET_RANK
                                    FROM PONDER.SALES_OPP_MDU_PROD T1
                                    LEFT JOIN PONDER.SALES_OPP_FIBER_ADDR T2
                                    ON T1.ZIP = T2.ZIP AND T1.HOUSE_NUMBER = T2.HOUSE_NUMBER AND T1.PREFIX = T2.PREFIX AND T1.STREET_NAME = T2.STREET_NAME 
                                    WHERE T1.HOUSE_NUMBER = '{1}' AND T1.PREFIX = '{2}' AND T1.STREET_NAME = '{3}' AND T1.ZIP = '{4}'
                                    ORDER BY T1.ZIP, T1.STREET_NAME, T1.PREFIX, T2.BUILDING_NUMBER, T2.UNIT_NUMBER" },
            {"showData_MDUAddressesZipFromMap",@"SELECT T1.SALES_MARKET AS VPGM_MARKET, T1.ZIP_CO_PSA, T1.WIRELESS_SCORE,
                                    CASE WHEN T1.WIRELESS_SCORE = 5 THEN 'Best'
                                    WHEN T1.WIRELESS_SCORE = 4 THEN 'Very Strong'
                                    WHEN T1.WIRELESS_SCORE = 3 THEN 'Strong'
                                    WHEN T1.WIRELESS_SCORE = 2 THEN 'Uneven'
                                    WHEN T1.WIRELESS_SCORE = 1 THEN 'Very Weak'
                                    ELSE 'Not enough Samples' END AS WIRELESS_SCORE_TEXT,
                                    T2.HOUSE_NUMBER, T2.PREFIX, T2.STREET_NAME, T2.BUILDING_NUMBER, T2.UNIT_NUMBER, 
                                    T2.CITY, T2.ZIP, T2.STATE, CASE WHEN T2.DL_MAX_SPEED > 1 THEN 'Yes' ELSE 'No' END AS HYPERGIG, CASE WHEN REGREEN = 1 THEN 'Yes' ELSE 'No' END AS REGREEN, CASE WHEN ADSL = 1 THEN 'Yes' ELSE 'No' END AS ADSL, CASE WHEN CSI_ELIGIBLE = 1 THEN 'Yes' ELSE 'No' END AS CSI_ELIGIBLE,
                                    CASE WHEN T2.SERVICE_STATUS = 'InService' THEN 'Customer' WHEN T2.SERVICE_STATUS IS NULL AND T2.BB_ALL = 1 AND T2.BB_FIBR = 0 THEN  'Upgrade' ELSE 'Prospect' END AS SERVICE_STATUS,
                                    T2.DWELLING_TYPE, T2.LATITUDE, T2.LONGITUDE, T1.ZIP_RANK, T1.MARKET_RANK
                                    FROM PONDER.SALES_OPP_MDU_PROD T1
                                    LEFT JOIN PONDER.SALES_OPP_FIBER_ADDR T2
                                    ON T1.ZIP = T2.ZIP AND T1.HOUSE_NUMBER = T2.HOUSE_NUMBER AND T1.PREFIX = T2.PREFIX AND T1.STREET_NAME = T2.STREET_NAME 
                                    WHERE T1.HOUSE_NUMBER = '{1}' AND T1.PREFIX = '{2}' AND T1.STREET_NAME = '{3}' AND T1.ZIP = '{4}'
                                    ORDER BY T1.ZIP, T1.STREET_NAME, T1.PREFIX, T2.BUILDING_NUMBER, T2.UNIT_NUMBER" },
            {"showData_MDUAddressesCountyFromTable",@"SELECT T1.SALES_MARKET AS VPGM_MARKET, T1.COUNTY_FIPS, T1.ZIP_CO_PSA, T1.WIRELESS_SCORE,
                                    CASE WHEN T1.WIRELESS_SCORE = 5 THEN 'Best'
                                    WHEN T1.WIRELESS_SCORE = 4 THEN 'Very Strong'
                                    WHEN T1.WIRELESS_SCORE = 3 THEN 'Strong'
                                    WHEN T1.WIRELESS_SCORE = 2 THEN 'Uneven'
                                    WHEN T1.WIRELESS_SCORE = 1 THEN 'Very Weak'
                                    ELSE 'Not enough Samples' END AS WIRELESS_SCORE_TEXT,
                                    T2.HOUSE_NUMBER, T2.PREFIX, T2.STREET_NAME, T2.BUILDING_NUMBER, T2.UNIT_NUMBER, 
                                    T2.CITY, T2.ZIP, T2.STATE, CASE WHEN T2.DL_MAX_SPEED > 1 THEN 'Yes' ELSE 'No' END AS HYPERGIG, CASE WHEN REGREEN = 1 THEN 'Yes' ELSE 'No' END AS REGREEN, CASE WHEN ADSL = 1 THEN 'Yes' ELSE 'No' END AS ADSL, CASE WHEN CSI_ELIGIBLE = 1 THEN 'Yes' ELSE 'No' END AS CSI_ELIGIBLE,
                                    CASE WHEN T2.SERVICE_STATUS = 'InService' THEN 'Customer' WHEN T2.SERVICE_STATUS IS NULL AND T2.BB_ALL = 1 AND T2.BB_FIBR = 0 THEN  'Upgrade' ELSE 'Prospect' END AS SERVICE_STATUS,  
                                    T2.DWELLING_TYPE, T2.LATITUDE, T2.LONGITUDE, T1.COUNTY_RANK, T1.MARKET_RANK
                                    FROM PONDER.SALES_OPP_MDU_PROD T1
                                    LEFT JOIN PONDER.SALES_OPP_FIBER_ADDR T2
                                    ON T1.ZIP = T2.ZIP AND T1.HOUSE_NUMBER = T2.HOUSE_NUMBER AND T1.PREFIX = T2.PREFIX AND T1.STREET_NAME = T2.STREET_NAME 
                                    WHERE T1.HOUSE_NUMBER = '{1}' AND T1.PREFIX = '{2}' AND T1.STREET_NAME = '{3}' AND T1.ZIP = '{4}'
                                    ORDER BY T1.ZIP, T1.STREET_NAME, T1.PREFIX, T2.BUILDING_NUMBER, T2.UNIT_NUMBER" },
            {"showData_MDUAddressesZipFromTable",@"SELECT T1.SALES_MARKET AS VPGM_MARKET, T1.ZIP_CO_PSA, T1.WIRELESS_SCORE,
                                    CASE WHEN T1.WIRELESS_SCORE = 5 THEN 'Best'
                                    WHEN T1.WIRELESS_SCORE = 4 THEN 'Very Strong'
                                    WHEN T1.WIRELESS_SCORE = 3 THEN 'Strong'
                                    WHEN T1.WIRELESS_SCORE = 2 THEN 'Uneven'
                                    WHEN T1.WIRELESS_SCORE = 1 THEN 'Very Weak'
                                    ELSE 'Not enough Samples' END AS WIRELESS_SCORE_TEXT,
                                    T2.HOUSE_NUMBER, T2.PREFIX, T2.STREET_NAME, T2.BUILDING_NUMBER, T2.UNIT_NUMBER, 
                                    T2.CITY, T2.ZIP, T2.STATE, CASE WHEN T2.DL_MAX_SPEED > 1 THEN 'Yes' ELSE 'No' END AS HYPERGIG, CASE WHEN REGREEN = 1 THEN 'Yes' ELSE 'No' END AS REGREEN, CASE WHEN ADSL = 1 THEN 'Yes' ELSE 'No' END AS ADSL, CASE WHEN CSI_ELIGIBLE = 1 THEN 'Yes' ELSE 'No' END AS CSI_ELIGIBLE,
                                    CASE WHEN T2.SERVICE_STATUS = 'InService' THEN 'Customer' WHEN T2.SERVICE_STATUS IS NULL AND T2.BB_ALL = 1 AND T2.BB_FIBR = 0 THEN  'Upgrade' ELSE 'Prospect' END AS SERVICE_STATUS,
                                    T2.DWELLING_TYPE, T2.LATITUDE, T2.LONGITUDE, T1.ZIP_RANK, T1.MARKET_RANK
                                    FROM PONDER.SALES_OPP_MDU_PROD T1
                                    LEFT JOIN PONDER.SALES_OPP_FIBER_ADDR T2
                                    ON T1.ZIP = T2.ZIP AND T1.HOUSE_NUMBER = T2.HOUSE_NUMBER AND T1.PREFIX = T2.PREFIX AND T1.STREET_NAME = T2.STREET_NAME 
                                    WHERE T1.HOUSE_NUMBER = '{1}' AND T1.PREFIX = '{2}' AND T1.STREET_NAME = '{3}' AND T1.ZIP = '{4}'
                                    ORDER BY T1.ZIP, T1.STREET_NAME, T1.PREFIX, T2.BUILDING_NUMBER, T2.UNIT_NUMBER" },
            {"showData_PSAAddressesCMAFromTable",@"SELECT TBL1.ZIP_CO_PSA, TBL1.HOUSE_NUMBER, TBL1.PREFIX, TBL1.STREET_NAME, TBL1.UNIT_NUMBER, TBL1.CITY, TBL1.ZIP, TBL1.STATE, TBL1.HYPERGIG, TBL1.REGREEN, TBL1.ADSL, TBL1.CSI_ELIGIBLE, TBL1.SERVICE_STATUS, TBL1.DWELLING_TYPE, TBL2.WIRELESS_SCORE FROM (
                                SELECT ZIP_CO_PSA, HOUSE_NUMBER, PREFIX, STREET_NAME, UNIT_NUMBER, CITY, ZIP, STATE, CASE WHEN DL_MAX_SPEED > 1 THEN 'Yes' ELSE 'No' END AS HYPERGIG, CASE WHEN REGREEN = 1 THEN 'Yes' ELSE 'No' END AS REGREEN, CASE WHEN ADSL = 1 THEN 'Yes' ELSE 'No' END AS ADSL, CASE WHEN CSI_ELIGIBLE = 1 THEN 'Yes' ELSE 'No' END AS CSI_ELIGIBLE,
                                CASE WHEN SERVICE_STATUS = 'InService' THEN 'Customer' WHEN SERVICE_STATUS IS NULL AND BB_ALL = 1 AND BB_FIBR = 0 THEN  'Upgrade' ELSE 'Prospect' END AS SERVICE_STATUS,  
                                DWELLING_TYPE
                                FROM PONDER.SALES_OPP_FIBER_ADDR 
                                WHERE ZIP_CO_PSA = '{0}')TBL1
                                LEFT JOIN
                                (SELECT ZIP_CO_PSA, WIRELESS_SCORE
                                FROM PONDER.SALES_OPP_PSA_PROD
                                WHERE ZIP_CO_PSA = '{1}')TBL2
                                ON TBL1.ZIP_CO_PSA = TBL2.ZIP_CO_PSA
                                ORDER BY TBL1.ZIP_CO_PSA, TBL1.STREET_NAME, TBL1.HOUSE_NUMBER, TBL1.UNIT_NUMBER" },
            {"showData_PSAAddressesCountyFromTable",@"SELECT TBL1.ZIP_CO_PSA, TBL1.HOUSE_NUMBER, TBL1.PREFIX, TBL1.STREET_NAME, TBL1.UNIT_NUMBER, TBL1.CITY, TBL1.ZIP, TBL1.STATE, TBL1.HYPERGIG, TBL1.REGREEN, TBL1.ADSL, TBL1.CSI_ELIGIBLE, TBL1.SERVICE_STATUS, TBL1.DWELLING_TYPE, TBL2.WIRELESS_SCORE FROM (
                                SELECT ZIP_CO_PSA, HOUSE_NUMBER, PREFIX, STREET_NAME, UNIT_NUMBER, CITY, ZIP, STATE, CASE WHEN DL_MAX_SPEED > 1 THEN 'Yes' ELSE 'No' END AS HYPERGIG, CASE WHEN REGREEN = 1 THEN 'Yes' ELSE 'No' END AS REGREEN, CASE WHEN ADSL = 1 THEN 'Yes' ELSE 'No' END AS ADSL, CASE WHEN CSI_ELIGIBLE = 1 THEN 'Yes' ELSE 'No' END AS CSI_ELIGIBLE,
                                CASE WHEN SERVICE_STATUS = 'InService' THEN 'Customer' WHEN SERVICE_STATUS IS NULL AND BB_ALL = 1 AND BB_FIBR = 0 THEN  'Upgrade' ELSE 'Prospect' END AS SERVICE_STATUS,  
                                DWELLING_TYPE
                                FROM PONDER.SALES_OPP_FIBER_ADDR 
                                WHERE ZIP_CO_PSA = '{0}')TBL1
                                LEFT JOIN
                                (SELECT ZIP_CO_PSA, WIRELESS_SCORE
                                FROM PONDER.SALES_OPP_PSA_PROD
                                WHERE ZIP_CO_PSA = '{1}')TBL2
                                ON TBL1.ZIP_CO_PSA = TBL2.ZIP_CO_PSA
                                ORDER BY TBL1.ZIP_CO_PSA, TBL1.STREET_NAME, TBL1.HOUSE_NUMBER, TBL1.UNIT_NUMBER" },
            {"showData_PSAAddressesFromTable",@"SELECT TBL1.ZIP_CO_PSA, TBL1.HOUSE_NUMBER, TBL1.PREFIX, TBL1.STREET_NAME, TBL1.UNIT_NUMBER, TBL1.CITY, TBL1.ZIP, TBL1.STATE, TBL1.HYPERGIG, TBL1.REGREEN, TBL1.ADSL, TBL1.CSI_ELIGIBLE, TBL1.SERVICE_STATUS, TBL1.DWELLING_TYPE, TBL2.WIRELESS_SCORE FROM (
                                SELECT ZIP_CO_PSA, HOUSE_NUMBER, PREFIX, STREET_NAME, UNIT_NUMBER, CITY, ZIP, STATE, CASE WHEN DL_MAX_SPEED > 1 THEN 'Yes' ELSE 'No' END AS HYPERGIG, CASE WHEN REGREEN = 1 THEN 'Yes' ELSE 'No' END AS REGREEN, CASE WHEN ADSL = 1 THEN 'Yes' ELSE 'No' END AS ADSL, CASE WHEN CSI_ELIGIBLE = 1 THEN 'Yes' ELSE 'No' END AS CSI_ELIGIBLE,
                                CASE WHEN SERVICE_STATUS = 'InService' THEN 'Customer' WHEN SERVICE_STATUS IS NULL AND BB_ALL = 1 AND BB_FIBR = 0 THEN  'Upgrade' ELSE 'Prospect' END AS SERVICE_STATUS, 
                                DWELLING_TYPE
                                FROM PONDER.SALES_OPP_FIBER_ADDR 
                                WHERE ZIP_CO_PSA = '{0}')TBL1
                                LEFT JOIN
                                (SELECT ZIP_CO_PSA, WIRELESS_SCORE
                                FROM PONDER.SALES_OPP_PSA_PROD
                                WHERE ZIP_CO_PSA = '{1}')TBL2
                                ON TBL1.ZIP_CO_PSA = TBL2.ZIP_CO_PSA
                                ORDER BY TBL1.ZIP_CO_PSA, TBL1.STREET_NAME, TBL1.HOUSE_NUMBER, TBL1.UNIT_NUMBER" },
            {"GetSearchAll", @"SELECT TBL4.*,
                                CASE WHEN ADJUSTED_DWELLING_TYPE = 'S' THEN SERVICE_STATUS
                                WHEN ADJUSTED_DWELLING_TYPE = 'M' THEN CONCAT(CONCAT(CONCAT(CONCAT('MDU - ', CUSTOMER_COUNT), ' of '), UNIT_COUNT), ' Units InService') END AS SHOW_SERVICE_STATUS
                                FROM(
                                SELECT HOUSE_NUMBER, PREFIX, STREET_NAME, CITY, STATE, ZIP, DWELLING_TYPE, UNIT_NUMBER, SERVICE_STATUS, ZIP_CO_PSA, LATITUDE, LONGITUDE, BB_ALL, BB_FIBR, WRLS,
                                CASE WHEN WIRELESS_SCORE = 5 THEN '5 (Best)'
                                    WHEN WIRELESS_SCORE = 4 THEN '4 (Very Strong)'
                                    WHEN WIRELESS_SCORE = 3 THEN '3 (Strong)'
                                    WHEN WIRELESS_SCORE = 2 THEN '2 (Uneven)'
                                    WHEN WIRELESS_SCORE = 1 THEN '1 (Very Weak)'
                                    ELSE 'Not enough Samples' END AS WIRELESS_SCORE, SHOW_MAP,
                                UNIT_COUNT, CUSTOMER_COUNT, UNIT_COUNT - CUSTOMER_COUNT AS OPPORTUNITY_COUNT, UPGRADE_COUNT, CASE WHEN(UNIT_COUNT > 1) THEN 'M' ELSE 'S' END AS ADJUSTED_DWELLING_TYPE,
                                CASE WHEN(RANK() OVER(PARTITION BY STREET_NAME, CITY, STATE, ZIP ORDER BY HOUSE_NUMBER, UNIT_NUMBER) = 1) THEN 'SHOW' ELSE 'HIDE' END AS SHOW_GROUP,
                                COUNT(*) OVER(PARTITION BY STREET_NAME, CITY, STATE, ZIP) AS TOTAL_NUM_UNITS,
                                SUM(CASE WHEN SERVICE_STATUS = 'InService' THEN 1 ELSE 0 END) OVER(PARTITION BY STREET_NAME, CITY, STATE, ZIP) AS TOTAL_CUSTOMERS,
                                SUM(CASE WHEN SERVICE_STATUS IS NULL THEN 1 ELSE 0 END) OVER(PARTITION BY STREET_NAME, CITY, STATE, ZIP) AS TOTAL_OPPORTUNITY,
                                SUM(UPGRADE_COUNT) OVER(PARTITION BY STREET_NAME, CITY, STATE, ZIP) AS TOTAL_UPGRADES, CASE WHEN DL_MAX_SPEED > 1 THEN 'Yes' ELSE 'No' END AS HYPERGIG, CASE WHEN REGREEN = 1 THEN 'Yes' ELSE 'No' END AS REGREEN, CASE WHEN ADSL = 1 THEN 'Yes' ELSE 'No' END AS ADSL, CASE WHEN CSI_ELIGIBLE = 1 THEN 'Yes' ELSE 'No' END AS CSI_ELIGIBLE
                                FROM(
                                SELECT TBL2.*, CASE WHEN(RANK() OVER(PARTITION BY HOUSE_NUMBER, PREFIX, STREET_NAME, CITY, STATE, ZIP ORDER BY UNIT_NUMBER) = 1) THEN 'SHOW' ELSE 'HIDE' END AS SHOW_MAP,
                                COUNT(*) OVER(PARTITION BY HOUSE_NUMBER, PREFIX, STREET_NAME, CITY, STATE, ZIP) AS UNIT_COUNT,
                                SUM(CASE WHEN SERVICE_STATUS = 'InService' THEN 1 ELSE 0 END) OVER(PARTITION BY HOUSE_NUMBER, PREFIX, STREET_NAME, CITY, STATE, ZIP) AS CUSTOMER_COUNT,
                                SUM(CASE WHEN SERVICE_STATUS IS NULL AND BB_FIBR = 0 AND BB_ALL = 1 THEN 1 ELSE 0 END) OVER(PARTITION BY HOUSE_NUMBER, PREFIX, STREET_NAME, CITY, STATE, ZIP) AS UPGRADE_COUNT
                                FROM(
                                SELECT TBL1.*, PONDER.SALES_OPP_PSA_PROD.WIRELESS_SCORE FROM(
                                SELECT HOUSE_NUMBER, PREFIX, STREET_NAME, CITY, STATE, ZIP, DWELLING_TYPE, UNIT_NUMBER, SERVICE_STATUS, ZIP_CO_PSA, LATITUDE, LONGITUDE, BB_ALL, BB_FIBR, WRLS, DL_MAX_SPEED, REGREEN, ADSL, CSI_ELIGIBLE
                                FROM PONDER.SALES_OPP_FIBER_ADDR WHERE {0} AND {1} AND {2} AND {3} AND {4})TBL1
                                LEFT OUTER JOIN PONDER.SALES_OPP_PSA_PROD ON TBL1.ZIP_CO_PSA = PONDER.SALES_OPP_PSA_PROD.ZIP_CO_PSA)TBL2)TBL3)TBL4" },
            {"GetSearchModalData", @"SELECT TDATE.DATA_DATE, TBL4.*,
                                CASE WHEN ADJUSTED_DWELLING_TYPE = 'S' THEN SERVICE_STATUS
                                WHEN ADJUSTED_DWELLING_TYPE = 'M' THEN CONCAT(CONCAT(CONCAT(CONCAT('MDU - ', CUSTOMER_COUNT), ' of '), UNIT_COUNT), ' Units InService') END AS SHOW_SERVICE_STATUS
                                FROM(
                                SELECT HOUSE_NUMBER, PREFIX, STREET_NAME, CITY, STATE, ZIP, DWELLING_TYPE, UNIT_NUMBER, SERVICE_STATUS, ZIP_CO_PSA, LATITUDE, LONGITUDE, BB_ALL, BB_FIBR, WRLS,
                                CASE WHEN WIRELESS_SCORE = 5 THEN '5 (Best)'
                                    WHEN WIRELESS_SCORE = 4 THEN '4 (Very Strong)'
                                    WHEN WIRELESS_SCORE = 3 THEN '3 (Strong)'
                                    WHEN WIRELESS_SCORE = 2 THEN '2 (Uneven)'
                                    WHEN WIRELESS_SCORE = 1 THEN '1 (Very Weak)'
                                    ELSE 'Not enough Samples' END AS WIRELESS_SCORE, SHOW_MAP,
                                UNIT_COUNT, CUSTOMER_COUNT, UNIT_COUNT - CUSTOMER_COUNT AS OPPORTUNITY_COUNT, UPGRADE_COUNT, CASE WHEN(UNIT_COUNT > 1) THEN 'M' ELSE 'S' END AS ADJUSTED_DWELLING_TYPE,
                                CASE WHEN(RANK() OVER(PARTITION BY STREET_NAME, CITY, STATE, ZIP ORDER BY HOUSE_NUMBER, UNIT_NUMBER) = 1) THEN 'SHOW' ELSE 'HIDE' END AS SHOW_GROUP,
                                COUNT(*) OVER(PARTITION BY STREET_NAME, CITY, STATE, ZIP) AS TOTAL_NUM_UNITS,
                                SUM(CASE WHEN SERVICE_STATUS = 'InService' THEN 1 ELSE 0 END) OVER(PARTITION BY STREET_NAME, CITY, STATE, ZIP) AS TOTAL_CUSTOMERS,
                                SUM(CASE WHEN SERVICE_STATUS IS NULL THEN 1 ELSE 0 END) OVER(PARTITION BY STREET_NAME, CITY, STATE, ZIP) AS TOTAL_OPPORTUNITY,
                                SUM(UPGRADE_COUNT) OVER(PARTITION BY STREET_NAME, CITY, STATE, ZIP) AS TOTAL_UPGRADES, CASE WHEN DL_MAX_SPEED > 1 THEN 'Yes' ELSE 'No' END AS HYPERGIG, CASE WHEN REGREEN = 1 THEN 'Yes' ELSE 'No' END AS REGREEN, CASE WHEN ADSL = 1 THEN 'Yes' ELSE 'No' END AS ADSL, CASE WHEN CSI_ELIGIBLE = 1 THEN 'Yes' ELSE 'No' END AS CSI_ELIGIBLE,
                                CASE WHEN MDU_HYPERGIG_CNT > 0 THEN 'Yes' ELSE 'No' END AS MDU_HYPERGIG,
                                CASE WHEN MDU_REGREEN_CNT > 0 THEN 'Yes' ELSE 'No' END AS MDU_REGREEN,
                                CASE WHEN MDU_ADSL_CNT > 0 THEN 'Yes' ELSE 'No' END AS MDU_ADSL,
                                CASE WHEN MDU_CSI_ELIGIBLE_CNT > 0 THEN 'Yes' ELSE 'No' END AS MDU_CSI_ELIGIBLE
                                FROM(
                                SELECT TBL2.*, CASE WHEN(RANK() OVER(PARTITION BY HOUSE_NUMBER, PREFIX, STREET_NAME, CITY, STATE, ZIP ORDER BY UNIT_NUMBER) = 1) THEN 'SHOW' ELSE 'HIDE' END AS SHOW_MAP,
                                COUNT(*) OVER(PARTITION BY HOUSE_NUMBER, PREFIX, STREET_NAME, CITY, STATE, ZIP) AS UNIT_COUNT,
                                SUM(CASE WHEN SERVICE_STATUS = 'InService' THEN 1 ELSE 0 END) OVER(PARTITION BY HOUSE_NUMBER, PREFIX, STREET_NAME, CITY, STATE, ZIP) AS CUSTOMER_COUNT,
                                SUM(CASE WHEN SERVICE_STATUS IS NULL AND BB_FIBR = 0 AND BB_ALL = 1 THEN 1 ELSE 0 END) OVER(PARTITION BY HOUSE_NUMBER, PREFIX, STREET_NAME, CITY, STATE, ZIP) AS UPGRADE_COUNT,
                                SUM(CASE WHEN DL_MAX_SPEED > 1 THEN 1 ELSE 0 END) OVER(PARTITION BY HOUSE_NUMBER, PREFIX, STREET_NAME, CITY, STATE, ZIP) AS MDU_HYPERGIG_CNT,
                                SUM(CASE WHEN REGREEN = 1 THEN 1 ELSE 0 END) OVER(PARTITION BY HOUSE_NUMBER, PREFIX, STREET_NAME, CITY, STATE, ZIP) AS MDU_REGREEN_CNT,
                                SUM(CASE WHEN ADSL = 1 THEN 1 ELSE 0 END) OVER(PARTITION BY HOUSE_NUMBER, PREFIX, STREET_NAME, CITY, STATE, ZIP) AS MDU_ADSL_CNT,
                                SUM(CASE WHEN CSI_ELIGIBLE = 1 THEN 1 ELSE 0 END) OVER(PARTITION BY HOUSE_NUMBER, PREFIX, STREET_NAME, CITY, STATE, ZIP) AS MDU_CSI_ELIGIBLE_CNT
                                FROM(
                                SELECT TBL1.*, PONDER.SALES_OPP_PSA_PROD.WIRELESS_SCORE FROM(
                                SELECT HOUSE_NUMBER, PREFIX, STREET_NAME, CITY, STATE, ZIP, DWELLING_TYPE, UNIT_NUMBER, SERVICE_STATUS, ZIP_CO_PSA, LATITUDE, LONGITUDE, BB_ALL, BB_FIBR, WRLS, DL_MAX_SPEED, REGREEN, ADSL, CSI_ELIGIBLE
                                FROM PONDER.SALES_OPP_FIBER_ADDR WHERE ZIP_CO_PSA = '{0}')TBL1
                                LEFT OUTER JOIN PONDER.SALES_OPP_PSA_PROD ON TBL1.ZIP_CO_PSA = PONDER.SALES_OPP_PSA_PROD.ZIP_CO_PSA)TBL2)TBL3)TBL4
                                LEFT JOIN (SELECT DATA_DATE FROM PONDER.SALES_OPP_DATA_INFO_TEST WHERE DATA_SOURCE = 'OVALS_Active_Fiber')TDATE ON 1=1" },
            {"GetPSAEventData", @"SELECT EVENT_ID,EVENT_NAME,FIBER_CHANNELS, TO_CHAR(START_DT,'MM/DD/YYYY') AS START_DT,STATUS,EVENT_ACTIVITY,ACTUAL_NEW_FIBER_SALES,ACTUAL_FIBER_MIGRATIONS,FORECAST_NEW_FIBER_SALES,FORECAST_FIBER_MIGRATIONS,PSA FROM PONDER.SALES_OPP_PSA_EVENT_DATA
                                WHERE (PSA LIKE ('%'||SUBSTR('{0}', 6)||'%') OR PSA = '{0}') ORDER BY START_DT DESC" },
            {"Get_Future_PSAs", @"SELECT PONDER.SALES_OPP_PSA_FUTURE_PROD.*, CONCAT(TO_CHAR((FIBER_CUSTOMERS*100/FIBER_AVAILABLE),'FM99990.0'),'%') AS FIBER_PENETRATION_RATE,
                                CASE WHEN DISTINCT_MAPPABLE / (FIBER_AVAILABLE - MISSING_LAT_LONG) >= .8 THEN 'Low - Few or No MDUs'
                                    WHEN DISTINCT_MAPPABLE / (FIBER_AVAILABLE - MISSING_LAT_LONG) <= .2 THEN 'High - Significant MDUs'
                                    ELSE 'Med - Some MDUs' END AS MDU_DENSITY_TEXT,
                                CASE WHEN WIRELESS_SCORE = 5 THEN '5 (Best)'
                                                                    WHEN WIRELESS_SCORE = 4 THEN '4 (Very Strong)'
                                                                    WHEN WIRELESS_SCORE = 3 THEN '3 (Strong)'
                                                                    WHEN WIRELESS_SCORE = 2 THEN '2 (Uneven)'
                                                                    WHEN WIRELESS_SCORE = 1 THEN '1 (Very Weak)'
                                                                    ELSE 'Not enough Samples' END AS WIRELESS_SCORE_TEXT
                                FROM PONDER.SALES_OPP_PSA_FUTURE_PROD WHERE SALES_MARKET LIKE '{0}'" },
            {"Get_Future_PSAs_Data", @"SELECT T1.*, TO_CHAR(T1.GRN_30DAY_DT, 'MM/DD/YYYY') AS GRN_30DAY_DT_TEXT, T2.WIRELESS_SCORE
                                        FROM PONDER.SALES_OPP_FIBER_ADDR_FUT_PROD T1
                                        LEFT JOIN PONDER.SALES_OPP_PSA_FUTURE_PROD T2
                                        ON T1.ZIP_CO_PSA = T2.ZIP_CO_PSA WHERE T1.ZIP_CO_PSA = '{0}'" },
            {"Get_Top25_PSAs", @"SELECT PONDER.SALES_OPP_PSA_PROD.*, CONCAT(TO_CHAR((FIBER_CUSTOMERS*100/FIBER_AVAILABLE),'FM99990.0'),'%') AS FIBER_PENETRATION_RATE,
                                CASE WHEN DISTINCT_MAPPABLE / (FIBER_AVAILABLE - MISSING_LAT_LONG) >= .8 THEN 'Low - Few or No MDUs'
                                    WHEN DISTINCT_MAPPABLE / (FIBER_AVAILABLE - MISSING_LAT_LONG) <= .2 THEN 'High - Significant MDUs'
                                    ELSE 'Med - Some MDUs' END AS MDU_DENSITY_TEXT,
                                CASE WHEN WIRELESS_SCORE = 5 THEN '5 (Best)'
                                                                    WHEN WIRELESS_SCORE = 4 THEN '4 (Very Strong)'
                                                                    WHEN WIRELESS_SCORE = 3 THEN '3 (Strong)'
                                                                    WHEN WIRELESS_SCORE = 2 THEN '2 (Uneven)'
                                                                    WHEN WIRELESS_SCORE = 1 THEN '1 (Very Weak)'
                                                                    ELSE 'Not enough Samples' END AS WIRELESS_SCORE_TEXT
                                FROM PONDER.SALES_OPP_PSA_PROD WHERE MARKET_RANK <= 25
                                AND (SALES_MARKET LIKE '{0}' OR SALES_REGION LIKE '{0}')" },
            {"Get_Top25_MDUs", @"SELECT PONDER.SALES_OPP_MDU_PROD.*,
                                CASE WHEN WIRELESS_SCORE = 5 THEN '5 (Best)'
                                                                    WHEN WIRELESS_SCORE = 4 THEN '4 (Very Strong)'
                                                                    WHEN WIRELESS_SCORE = 3 THEN '3 (Strong)'
                                                                    WHEN WIRELESS_SCORE = 2 THEN '2 (Uneven)'
                                                                    WHEN WIRELESS_SCORE = 1 THEN '1 (Very Weak)'
                                                                    ELSE 'Not enough Samples' END AS WIRELESS_SCORE_TEXT,
                                FIBER_AVAILABLE - FIBER_OPPORTUNITY AS FIBER_CUSTOMERS
                                FROM PONDER.SALES_OPP_MDU_PROD WHERE MARKET_RANK <= 25
                                AND (SALES_MARKET LIKE '{0}' OR SALES_REGION LIKE '{0}')" },
            {"Get_CopperUpgrade_Data", @"SELECT TDATE.DATA_DATE, T1.* FROM(SELECT ZIP_CO_PSA, LATITUDE, LONGITUDE,
                                        CASE WHEN WIRELESS_SCORE = 5 THEN '5 (Best)'
                                        WHEN WIRELESS_SCORE = 4 THEN '4 (Very Strong)'
                                        WHEN WIRELESS_SCORE = 3 THEN '3 (Strong)'
                                        WHEN WIRELESS_SCORE = 2 THEN '2 (Uneven)'
                                        WHEN WIRELESS_SCORE = 1 THEN '1 (Very Weak)'
                                        ELSE 'Not enough Samples' END AS SIMPLE_COVERAGE_SCORE,
                                         COPPER_UPGRADE, FIBER_AVAILABLE, FIBER_CUSTOMERS,
                                         CONCAT(ROUND(100 * FIBER_CUSTOMERS / FIBER_AVAILABLE,1), '%') AS FIBER_PENETRATION, FIBER_OPPORTUNITY, 
                                         CASE WHEN DISTINCT_MAPPABLE / (FIBER_AVAILABLE - MISSING_LAT_LONG) >= .8 THEN 'Low - Few or No MDUs'
                                         WHEN DISTINCT_MAPPABLE / (FIBER_AVAILABLE - MISSING_LAT_LONG) <= .2 THEN 'High - Significant MDUs'
                                         ELSE 'Med - Some MDUs' END AS MDU_DENSITY_TEXT,
                                         MARKET_RANK, DISTINCT_MAPPABLE, MISSING_LAT_LONG, WIRELESS_SCORE , CMA, CMA_NAME, COUNTY_FIPS, ZIP 
                                         FROM PONDER.SALES_OPP_PSA_PROD WHERE {0}) T1
                                         LEFT JOIN (SELECT DATA_DATE FROM PONDER.SALES_OPP_DATA_INFO_TEST WHERE DATA_SOURCE = 'OVALS_Active_Fiber')TDATE ON 1=1
                                         ORDER BY T1.MARKET_RANK ASC"  },
};
    }
}
